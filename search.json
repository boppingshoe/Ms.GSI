[{"path":"https://boppingshoe.github.io/Ms.GSI/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Ms.GSI authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"document contains background information integrated multistage genetic stock identification (GSI) model two parts. first part describes use package Ms.GSI conduct GSI analysis. steps include formatting input data, running integrated multistage GSI model, summarizing results. second part details technical background integrated multistage GSI model mathematical theory. separate article describe general background integrated multistage framework (add link integrated multistage paper).","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"how-to-use-ms-gsi","dir":"Articles","previous_headings":"","what":"How to use Ms.GSI","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"Ms.GSI follows work flow: format input data, run integrated multistage model, summarize results/convergence diagnostics.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"input-data","dir":"Articles","previous_headings":"How to use Ms.GSI","what":"Input data","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"pieces information needed input data set: broad-scale baseline regional baseline mixture sample broad-scale population information regional population information pre-loaded example data sets available Ms.GSI. look one time. Note example data sets simulated using existing baseline archived Alaska Department Fish & Game Gene Conservation Lab (GCL). fabricated data set represent true population proportions real fisheries. example, made scenario similar Bering Sea groundfish fisheries Chinook salmon harvested bycatch originated wide range geographic areas. Within bycatch sample, interested proportion contribution lower, middle upper Yukon River reporting groups (see map ). used coast-wide data set Chinook salmon (Templin et al. 2011; Templin baseline hereafter) broad-scale baseline separate Yukon River fish non-Yukon stocks data set first stage analysis. However, genetic markers Templin baseline unable clearly distinguish lower Yukon River coastal western Alaska populations, used second baseline additional genetic markers specifically designed differentiate Yukon River Chinook salmon populations (Lee et al. 2021; Yukon River baseline hereafter) regional fine-scale baseline second stage. important note original grouping Templin baseline, Lower Yukon part Coastal Western Alaska reporting group. isolated Lower Yukon rest Coastal Western Alaska, accuracy proportion estimates likely diminish breakup Coastal Western Alaska reporting group. recommend using genetic baseline beyond original design. researchers aware capability genetic baselines utilizing integrated multistage model. example, ideal keep Coastal Western Alaska group intact broad-scale baseline, break group Lower Yukon others using fine-scale regional baseline. However, time writing, regional baseline adequate resolution still development. Collection locations color-coded reporting groups Chinook salmon represented Yukon River example. Shaded area represents Yukon River region. assembled mixture sample containing 150 individuals collection sites across Yukon River, coastal western Alaskan, Alaska Peninsula, Gulf Alaska, Kamchatka Peninsula (Russia). collections grouped five reporting groups: Lower Yukon, Middle Yukon, Upper Yukon, Coastal Western Alaska (Coastal West Alaska), Others.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"mixture","dir":"Articles","previous_headings":"How to use Ms.GSI > Input data","what":"Mixture","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"First take look baseline mixture samples. Ms.GSI accepts genotype information two format: 1) GCL format 2) package rubias format. example data sets rubias format naming convention, procedures GCL format same1. Columns 5 358 contain genotype information loci broad-scale regional baselines. specify loci baseline (can want double check, later). Ms.GSI matches loci mixture baselines long locus names consistent. fish known-origin, can specify identities adding column called known_collection mixture data set. entry known-origin match collection name broad-scale baseline. Fish unknown-origin NA entry.","code":"print(dplyr::as_tibble(mix)) #> # A tibble: 150 × 358 #>    sample_type repunit collection indiv   `GTH2B-550` `GTH2B-550.1` NOD1  NOD1.1 #>    <chr>       <lgl>   <chr>      <chr>   <chr>       <chr>         <chr> <chr>  #>  1 mixture     NA      Bering Sea fish_1  C           G             C     C      #>  2 mixture     NA      Bering Sea fish_2  C           C             C     G      #>  3 mixture     NA      Bering Sea fish_3  C           C             C     G      #>  4 mixture     NA      Bering Sea fish_4  C           C             C     C      #>  5 mixture     NA      Bering Sea fish_5  C           G             C     G      #>  6 mixture     NA      Bering Sea fish_6  C           C             C     G      #>  7 mixture     NA      Bering Sea fish_7  C           C             NA    NA     #>  8 mixture     NA      Bering Sea fish_8  C           G             NA    NA     #>  9 mixture     NA      Bering Sea fish_9  C           G             C     G      #> 10 mixture     NA      Bering Sea fish_10 C           G             NA    NA     #> # ℹ 140 more rows #> # ℹ 350 more variables: `Ots_100884-287` <chr>, `Ots_100884-287.1` <chr>, #> #   `Ots_101554-407` <chr>, `Ots_101554-407.1` <chr>, `Ots_102414-395` <chr>, #> #   `Ots_102414-395.1` <chr>, `Ots_102867-609` <chr>, `Ots_102867-609.1` <chr>, #> #   `Ots_103041-52` <chr>, `Ots_103041-52.1` <chr>, `Ots_103122-180` <chr>, #> #   `Ots_103122-180.1` <chr>, `Ots_104048-194` <chr>, `Ots_104048-194.1` <chr>, #> #   `Ots_104063-132` <chr>, `Ots_104063-132.1` <chr>, `Ots_104415-88` <chr>, …"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"broad-scale-baseline","dir":"Articles","previous_headings":"How to use Ms.GSI > Input data","what":"Broad-scale baseline","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"Next, take look broad-scale (Templin) baseline example provided Ms.GSI. originally 45 loci Templin baseline, reduced marker set 28 loci due limitation data size (technical reasons). However, demonstration purpose, data set suffice.","code":"print(dplyr::as_tibble(base_templin)) #> # A tibble: 29,363 × 60 #>    sample_type repunit collection indiv   `GTH2B-550` `GTH2B-550.1` NOD1  NOD1.1 #>    <chr>       <chr>   <chr>      <chr>   <chr>       <chr>         <chr> <chr>  #>  1 reference   Russia  KBIST98L   KBIST9… C           C             C     G      #>  2 reference   Russia  KBIST98L   KBIST9… C           G             C     G      #>  3 reference   Russia  KBIST98L   KBIST9… C           G             C     G      #>  4 reference   Russia  KBIST98L   KBIST9… C           C             G     G      #>  5 reference   Russia  KBIST98L   KBIST9… C           G             G     G      #>  6 reference   Russia  KBIST98L   KBIST9… C           C             C     C      #>  7 reference   Russia  KBIST98L   KBIST9… C           G             C     G      #>  8 reference   Russia  KBIST98L   KBIST9… C           C             C     G      #>  9 reference   Russia  KBIST98L   KBIST9… C           G             C     G      #> 10 reference   Russia  KBIST98L   KBIST9… C           C             G     G      #> # ℹ 29,353 more rows #> # ℹ 52 more variables: `Ots_2KER-137` <chr>, `Ots_2KER-137.1` <chr>, #> #   `Ots_AsnRS-72` <chr>, `Ots_AsnRS-72.1` <chr>, Ots_ETIF1A <chr>, #> #   Ots_ETIF1A.1 <chr>, `Ots_GPH-318` <chr>, `Ots_GPH-318.1` <chr>, #> #   `Ots_GST-207` <chr>, `Ots_GST-207.1` <chr>, `Ots_hnRNPL-533` <chr>, #> #   `Ots_hnRNPL-533.1` <chr>, `Ots_HSP90B-100` <chr>, `Ots_HSP90B-100.1` <chr>, #> #   `Ots_IGF1-91` <chr>, `Ots_IGF1-91.1` <chr>, `Ots_IK1-328` <chr>, …"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"regional-baseline","dir":"Articles","previous_headings":"How to use Ms.GSI > Input data","what":"Regional baseline","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"regional baseline (Yukon) format. originally 380 loci Yukon River Chinook baseline, reduced numbers 177 demonstration.","code":"print(dplyr::as_tibble(base_yukon)) #> # A tibble: 5,435 × 358 #>    sample_type repunit   collection indiv `GTH2B-550` `GTH2B-550.1` NOD1  NOD1.1 #>    <chr>       <chr>     <chr>      <chr> <chr>       <chr>         <chr> <chr>  #>  1 reference   Lower Yu… KANDR02.K… KAND… G           G             C     C      #>  2 reference   Lower Yu… KANDR02.K… KAND… C           G             C     C      #>  3 reference   Lower Yu… KANDR02.K… KAND… G           G             C     C      #>  4 reference   Lower Yu… KANDR02.K… KAND… G           G             C     G      #>  5 reference   Lower Yu… KANDR02.K… KAND… C           G             C     C      #>  6 reference   Lower Yu… KANDR02.K… KAND… C           C             C     C      #>  7 reference   Lower Yu… KANDR02.K… KAND… C           G             G     G      #>  8 reference   Lower Yu… KANDR02.K… KAND… C           C             G     G      #>  9 reference   Lower Yu… KANDR02.K… KAND… C           C             G     G      #> 10 reference   Lower Yu… KANDR02.K… KAND… C           G             C     G      #> # ℹ 5,425 more rows #> # ℹ 350 more variables: `Ots_100884-287` <chr>, `Ots_100884-287.1` <chr>, #> #   `Ots_101554-407` <chr>, `Ots_101554-407.1` <chr>, `Ots_102414-395` <chr>, #> #   `Ots_102414-395.1` <chr>, `Ots_102867-609` <chr>, `Ots_102867-609.1` <chr>, #> #   `Ots_103041-52` <chr>, `Ots_103041-52.1` <chr>, `Ots_103122-180` <chr>, #> #   `Ots_103122-180.1` <chr>, `Ots_104048-194` <chr>, `Ots_104048-194.1` <chr>, #> #   `Ots_104063-132` <chr>, `Ots_104063-132.1` <chr>, `Ots_104415-88` <chr>, …"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"population-information","dir":"Articles","previous_headings":"How to use Ms.GSI > Input data","what":"Population information","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"Another piece information needed population details baseline. need include three columns population information table. Column collection contains names population baseline. Column reunit specifies reporting group population belongs . Column grpvec specifies identification number reporting group. shows first ten rows population information Templin (broad-scale) baseline. hatchery populations mixture sample, can tell Ms.GSI either collection belongs natural hatchery-origin adding origin column population information table. origin column, identify collection \"wild\" \"hatchery\". don’t care separate natural hatchery origins, can lump one collection. case, don’t need add origin column. Also, option identify hatchery fish available broad-scale baseline, don’t add origin column population table regional baseline. Population information table Yukon (regional) baseline format, necessarily order. data files ready (recommend saving .Rdata .Rds files), can use prep_msgsi_data() function convert input data set model run. ’ll also need identify “groups interest” parameter sub-group. example, groups interests Lower Yukon, Middle Yukon Upper Yukon reporting groups. identify numbers 3, 4, 5 broad-scale baseline. ’s option save input data designated directory identifying location parameter file_path. prep_msgsi_data() function matches loci mixture baselines. want make sure didn’t miss locus baselines mixture, can manually provide loci names (string vector) baseline inputting loci1 loci2. example don’t manually provide lists loci trust mixture baselines correct loci. prep_msgsi_data() formats data files put list. took around ten seconds format input data case. Bigger data sets may take longer. first rows/items input data list:","code":"print(dplyr::as_tibble(templin_pops211)) #> # A tibble: 211 × 3 #>    collection       repunit             grpvec #>    <chr>            <chr>                <dbl> #>  1 KBIST98L         Russia                   1 #>  2 KBOLS02.KBOLS98E Russia                   1 #>  3 KKAMC97.KKAMC98L Russia                   1 #>  4 KPAKH02          Russia                   1 #>  5 KPILG05.KPILG06  Coastal West Alaska      2 #>  6 KUNAL05          Coastal West Alaska      2 #>  7 KGOLS05.KGOLS06  Coastal West Alaska      2 #>  8 KANDR02.KANDR03  Lower Yukon              3 #>  9 KANVI02          Lower Yukon              3 #> 10 KGISA01          Lower Yukon              3 #> # ℹ 201 more rows print(dplyr::as_tibble(yukon_pops50)) #> # A tibble: 50 × 3 #>    collection                          grpvec repunit      #>    <chr>                                <dbl> <chr>        #>  1 KANDR02.KANDR03                          1 Lower Yukon  #>  2 KANVI03.KANVI07                          1 Lower Yukon  #>  3 KNUL12SF                                 1 Lower Yukon  #>  4 KNUL12NF                                 1 Lower Yukon  #>  5 KGISA01                                  1 Lower Yukon  #>  6 KKATE02.KKATE12                          1 Lower Yukon  #>  7 KHENS01                                  2 Middle Yukon #>  8 KHENS07.KHENS15                          2 Middle Yukon #>  9 KSFKOY03                                 2 Middle Yukon #> 10 KMFKOY10.KMFKOY11.KMFKOY12.KMFKOY13      2 Middle Yukon #> # ℹ 40 more rows msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 12.85391 secs lapply(msgsi_dat, head) #> $x #> # A tibble: 6 × 74 #>   indiv    `GTH2B-550_1` `GTH2B-550_2` NOD1_1 NOD1_2 `Ots_2KER-137_1` #>   <chr>            <int>         <int>  <int>  <int>            <int> #> 1 fish_1               1             1      2      0                0 #> 2 fish_10              1             1      0      0                1 #> 3 fish_100             1             1      1      1                1 #> 4 fish_101             1             1      1      1                1 #> 5 fish_102             0             2      0      2                0 #> 6 fish_103             2             0      1      1                1 #> # ℹ 68 more variables: `Ots_2KER-137_2` <int>, `Ots_2KER-137_3` <int>, #> #   `Ots_AsnRS-72_1` <int>, `Ots_AsnRS-72_2` <int>, `Ots_AsnRS-72_3` <int>, #> #   Ots_ETIF1A_1 <int>, Ots_ETIF1A_2 <int>, `Ots_GPH-318_1` <int>, #> #   `Ots_GPH-318_2` <int>, `Ots_GST-207_1` <int>, `Ots_GST-207_2` <int>, #> #   `Ots_HSP90B-100_1` <int>, `Ots_HSP90B-100_2` <int>, `Ots_IGF1-91_1` <int>, #> #   `Ots_IGF1-91_2` <int>, `Ots_IGF1-91_3` <int>, `Ots_IK1-328_1` <int>, #> #   `Ots_IK1-328_2` <int>, `Ots_IK1-328_3` <int>, `Ots_LEI-292_1` <int>, … #>  #> $x2 #> # A tibble: 6 × 355 #>   indiv    `GTH2B-550_1` `GTH2B-550_2` NOD1_1 NOD1_2 `Ots_100884-287_1` #>   <chr>            <int>         <int>  <int>  <int>              <int> #> 1 fish_1               1             1      2      0                  2 #> 2 fish_10              1             1      0      0                  0 #> 3 fish_100             1             1      1      1                  1 #> 4 fish_101             1             1      1      1                  2 #> 5 fish_102             2             0      0      2                  1 #> 6 fish_103             0             2      1      1                  1 #> # ℹ 349 more variables: `Ots_100884-287_2` <int>, `Ots_101554-407_1` <int>, #> #   `Ots_101554-407_2` <int>, `Ots_102414-395_1` <int>, #> #   `Ots_102414-395_2` <int>, `Ots_102867-609_1` <int>, #> #   `Ots_102867-609_2` <int>, `Ots_103041-52_1` <int>, `Ots_103041-52_2` <int>, #> #   `Ots_103122-180_1` <int>, `Ots_103122-180_2` <int>, #> #   `Ots_104048-194_1` <int>, `Ots_104048-194_2` <int>, #> #   `Ots_104063-132_1` <int>, `Ots_104063-132_2` <int>, … #>  #> $y #> # A tibble: 6 × 76 #>   collection            repunit grpvec `GTH2B-550_1` `GTH2B-550_2` NOD1_1 NOD1_2 #>   <chr>                 <chr>    <dbl>         <int>         <int>  <int>  <int> #> 1 CHBIG92.KIBIG93.KBIG… Northe…      9           254            82    104    228 #> 2 CHCRY92.KICRY94.KCRY… Coasta…     10           306           302    120    488 #> 3 CHDMT92.KDEER94       Coasta…     10           178           116     77    217 #> 4 CHKAN92.KIKAN93.KKAN… Coasta…      2           341           147    281    199 #> 5 CHKOG92.KIKOG93.KKOG… Coasta…      2           205            91    191    105 #> 6 CHNUU92.KINUS93       Coasta…      2            85            27     73     41 #> # ℹ 69 more variables: `Ots_2KER-137_1` <int>, `Ots_2KER-137_2` <int>, #> #   `Ots_2KER-137_3` <int>, `Ots_AsnRS-72_1` <int>, `Ots_AsnRS-72_2` <int>, #> #   `Ots_AsnRS-72_3` <int>, Ots_ETIF1A_1 <int>, Ots_ETIF1A_2 <int>, #> #   `Ots_GPH-318_1` <int>, `Ots_GPH-318_2` <int>, `Ots_GST-207_1` <int>, #> #   `Ots_GST-207_2` <int>, `Ots_HSP90B-100_1` <int>, `Ots_HSP90B-100_2` <int>, #> #   `Ots_IGF1-91_1` <int>, `Ots_IGF1-91_2` <int>, `Ots_IGF1-91_3` <int>, #> #   `Ots_IK1-328_1` <int>, `Ots_IK1-328_2` <int>, `Ots_IK1-328_3` <int>, … #>  #> $y2 #> # A tibble: 6 × 357 #>   collection            grpvec repunit `GTH2B-550_1` `GTH2B-550_2` NOD1_1 NOD1_2 #>   <chr>                  <dbl> <chr>           <int>         <int>  <int>  <int> #> 1 CHSID92j                   3 Upper …             7           183    116     74 #> 2 K100MILECR16.K100MIL…      3 Upper …             7           103     78     34 #> 3 KANDR02.KANDR03            1 Lower …            78           230    208    100 #> 4 KANVI03.KANVI07            1 Lower …            62           164    131     79 #> 5 KBEAV97                    2 Middle…            40           148    152     38 #> 6 KBIGS87.KBIGS07            3 Upper …            30           258    231     65 #> # ℹ 350 more variables: `Ots_100884-287_1` <int>, `Ots_100884-287_2` <int>, #> #   `Ots_101554-407_1` <int>, `Ots_101554-407_2` <int>, #> #   `Ots_102414-395_1` <int>, `Ots_102414-395_2` <int>, #> #   `Ots_102867-609_1` <int>, `Ots_102867-609_2` <int>, #> #   `Ots_103041-52_1` <int>, `Ots_103041-52_2` <int>, `Ots_103122-180_1` <int>, #> #   `Ots_103122-180_2` <int>, `Ots_104048-194_1` <int>, #> #   `Ots_104048-194_2` <int>, `Ots_104063-132_1` <int>, … #>  #> $iden #> NULL #>  #> $nalleles #>    GTH2B-550         NOD1 Ots_2KER-137 Ots_AsnRS-72   Ots_ETIF1A  Ots_GPH-318  #>            2            2            3            3            2            2  #>  #> $nalleles2 #>      GTH2B-550           NOD1 Ots_100884-287 Ots_101554-407 Ots_102414-395  #>              2              2              2              2              2  #> Ots_102867-609  #>              2  #>  #> $groups #> [1]  9 10 10  2  2  2 #>  #> $p2_groups #> [1] 3 3 1 1 2 3 #>  #> $sub_group #> [1] 3 4 5 #>  #> $group_names_t1 #> [1] \"Russia\"                 \"Coastal West Alaska\"    \"Lower Yukon\"            #> [4] \"Middle Yukon\"           \"Upper Yukon\"            \"North Alaska Peninsula\" #>  #> $group_names_t2 #> [1] \"Lower Yukon\"  \"Middle Yukon\" \"Upper Yukon\"  #>  #> $wildpops #> [1] \"CHBIG92.KIBIG93.KBIGB04.KBIGB95\" \"CHCRY92.KICRY94.KCRYA05\"         #> [3] \"CHDMT92.KDEER94\"                 \"CHKAN92.KIKAN93.KKANE05\"         #> [5] \"CHKOG92.KIKOG93.KKOGR05\"         \"CHNUU92.KINUS93\"                 #>  #> $hatcheries #> NULL"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"genetic-stock-identification","dir":"Articles","previous_headings":"How to use Ms.GSI","what":"Genetic stock identification","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"input data set ready, can use msgsi_mdl() run model. used running rubias, Ms.GSI might feel bit slow. 1) running two GSI models tandem, takes twice long running single model, 2) Ms.GSI written solely R, computationally efficient language C. , code Ms.GSI C? ’re technically advanced like folks developed rubias package (.e., don’t know code C++). running time, recommend running integrated multistage model conditional GSI mode (default setting). option run model fully Bayesian mode one choose . run model fully Bayesian mode, option include numbers adaptation run. people think adaptation run encourages convergence fully Bayesian mode. test theory provide option want try . demonstrate model run one chains 150 iterations (first 50 warm-runs, burn-ins). run one chain example can pass CMD check building vignette document2. reality, definitely run multiple chains iterations. also options keep burn-ins set random seed reproducible results. don’t show example though (can always ?msgsi_mdl).","code":"msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 150, nburn = 50, thin = 1, nchains = 1) #> Running model (and the category is... Perfect Tens!) #> Time difference of 2.706586 secs #> June-08-2023 23:57"},{"path":[]},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"stock-proportions","dir":"Articles","previous_headings":"How to use Ms.GSI > Summarizing results","what":"Stock proportions","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"output model contains eight items: summ_t1, trace_t1, summ_t2, trace_t2, summ_comb, trace_comb, iden_t1 idens_t2. Items “summ” summary reporting group proportions associated convergence diagnostics. want see summaries stage one two individually, summ_t1 summ_t2 show . people probably want see combined summary, summ_comb. column names self explanatory, others might need additional descriptions. ci.05 ci.95 lower upper bounds 90% credible interval. GR Gelman-Rubin statistic (.k.. \\(\\hat R\\)). example, Gelman-Rubin statistic calculated run one chain. n_eff effective size, \\(N_{eff}\\). discuss diagnose convergence document. Please consult Gelman et al. 2014, Gelman & Rubin 1992, Brooks & Gelman 1998 literature statistical methods. Items “trace” posterior sample history, trace history, either stage one, two, combined. Trace history needed making trace plots. need combine reporting groups proportions combine variance, trace histories need. trace_ items tibbles reporting group column. two additional columns, itr chain, identify Markov chain Monte Carlo (MCMC) sampling iteration chain.","code":"msgsi_out$summ_comb #> # A tibble: 12 × 8 #>    group                      mean  median      sd    ci.05   ci.95 GR     n_eff #>    <chr>                     <dbl>   <dbl>   <dbl>    <dbl>   <dbl> <lgl>  <dbl> #>  1 Russia                  2.27e-2 2.15e-2 1.59e-2 6.92e- 6 0.0465  NA     27.0  #>  2 Coastal West Alaska     8.83e-2 6.29e-2 9.33e-2 3.53e-11 0.271   NA      1.86 #>  3 North Alaska Peninsula  4.93e-3 2.54e-5 1.06e-2 7.18e-17 0.0262  NA      6.46 #>  4 Northwest Gulf of Alas… 2.84e-1 2.77e-1 5.47e-2 2.03e- 1 0.368   NA     21.5  #>  5 Copper                  7.26e-4 2.14e-6 1.95e-3 7.10e-19 0.00427 NA     31.9  #>  6 Northeast Gulf of Alas… 4.87e-4 8.02e-7 1.52e-3 2.55e-18 0.00220 NA     55.7  #>  7 Coastal Southeast Alas… 9.32e-4 2.06e-6 3.25e-3 2.90e-17 0.00520 NA     50.5  #>  8 British Columbia        1.85e-4 8.14e-8 6.56e-4 4.48e-18 0.00115 NA    100    #>  9 WA/OR/CA                4.87e-4 2.21e-6 1.26e-3 2.85e-20 0.00264 NA    100    #> 10 Lower Yukon             3.41e-1 3.79e-1 1.12e-1 1.41e- 1 0.479   NA      1.16 #> 11 Middle Yukon            7.63e-2 7.44e-2 2.19e-2 4.41e- 2 0.113   NA     70.0  #> 12 Upper Yukon             1.80e-1 1.74e-1 3.09e-2 1.37e- 1 0.240   NA    100 msgsi_out$trace_comb #> # A tibble: 100 × 14 #>      Russia `Coastal West Alaska` North Alaska Peninsul…¹ Northwest Gulf of Al…² #>       <dbl>                 <dbl>                   <dbl>                  <dbl> #>  1 5.65e-19                 0.175                7.99e- 8                  0.346 #>  2 2.67e- 4                 0.149                7.20e-17                  0.288 #>  3 3.98e-15                 0.143                6.81e-10                  0.260 #>  4 9.83e- 7                 0.107                3.19e-15                  0.324 #>  5 3.17e- 7                 0.153                7.02e- 4                  0.336 #>  6 1.64e-12                 0.140                1.36e-14                  0.339 #>  7 7.23e- 6                 0.137                1.74e- 3                  0.407 #>  8 1.58e- 5                 0.174                1.02e-16                  0.450 #>  9 8.47e- 4                 0.224                4.03e-15                  0.352 #> 10 3.00e- 3                 0.201                9.55e- 4                  0.392 #> # ℹ 90 more rows #> # ℹ abbreviated names: ¹​`North Alaska Peninsula`, ²​`Northwest Gulf of Alaska` #> # ℹ 10 more variables: Copper <dbl>, `Northeast Gulf of Alaska` <dbl>, #> #   `Coastal Southeast Alaska` <dbl>, `British Columbia` <dbl>, #> #   `WA/OR/CA` <dbl>, `Lower Yukon` <dbl>, `Middle Yukon` <dbl>, #> #   `Upper Yukon` <dbl>, itr <dbl>, chain <dbl>"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"individual-assignments","dir":"Articles","previous_headings":"How to use Ms.GSI > Summarizing results","what":"Individual assignments","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"last two items output identity assignment history individual mixture sample. column represents individual mixture, row records identity assigned iteration chain. numbers population identifiers order population information files (baseline files). Individuals ordered input data (.e., mixture data). Individual identity output format may useful users. , Ms.GSI function indiv_assign() summarize reporting group assignment probabilities individual mixture. summary individual assignment column named ID identifies individual mixture. regional column shows probability individual belong group interest, , within region focus. rest columns probabilities regional reporting groups. Probabilities row sum one.","code":"msgsi_out$idens_t1 #> # A tibble: 100 × 150 #>       V1    V2    V3    V4    V5    V6    V7    V8    V9   V10   V11   V12   V13 #>    <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> #>  1    11   192    11    56    97   152    97    95    32    56    84   192    97 #>  2    95    84    97    11    56   152    97   192    95    11    84    11    11 #>  3    84    87   192    95    84    11    97    32    11    11    97    84    11 #>  4    15    11    11   192    97   152    97   192    97    11    97    11    11 #>  5    11    11    11    32    39   152    97    87    11    11    97    97    56 #>  6    11   152    97    11    84    97    97    39    11    11    97    32    56 #>  7    11    87    97    87    56    11    97    11    56   192    11    84    11 #>  8    11    11    56    56    32   152    97    32    56    56    32    11    11 #>  9    11    56    32    32    56    84    97    39    87    87    84    84    84 #> 10    32    11   192    84    56   152   152    87    32    56    11    39    84 #> # ℹ 90 more rows #> # ℹ 137 more variables: V14 <int>, V15 <int>, V16 <int>, V17 <int>, V18 <int>, #> #   V19 <int>, V20 <int>, V21 <int>, V22 <int>, V23 <int>, V24 <int>, #> #   V25 <int>, V26 <int>, V27 <int>, V28 <int>, V29 <int>, V30 <int>, #> #   V31 <int>, V32 <int>, V33 <int>, V34 <int>, V35 <int>, V36 <int>, #> #   V37 <int>, V38 <int>, V39 <int>, V40 <int>, V41 <int>, V42 <int>, #> #   V43 <int>, V44 <int>, V45 <int>, V46 <int>, V47 <int>, V48 <int>, … indiv_assign(mdl_out = msgsi_out, mdl_dat = msgsi_dat) #> # A tibble: 150 × 5 #>    ID       `Not regional` `Lower Yukon` `Middle Yukon` `Upper Yukon` #>  * <chr>             <dbl>         <dbl>          <dbl>         <dbl> #>  1 fish_1             0.47          0.53              0             0 #>  2 fish_10            0.42          0.58              0             0 #>  3 fish_100           0.87          0.13              0             0 #>  4 fish_101           0.5           0.5               0             0 #>  5 fish_102           0.86          0.14              0             0 #>  6 fish_103           0.11          0.89              0             0 #>  7 fish_104           0.51          0.49              0             0 #>  8 fish_105           0.78          0.22              0             0 #>  9 fish_106           0.62          0.38              0             0 #> 10 fish_107           0.38          0.62              0             0 #> # ℹ 140 more rows"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"trace-plot","dir":"Articles","previous_headings":"How to use Ms.GSI > Summarizing results","what":"Trace plot","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"Ms.GSI function make trace plot examine mixing MCMC chains. Trace plots reporting group proportions. \\[\\newcommand{\\mx}[1]{\\mathbf{#1}}\\]","code":"tr_plot(obj = msgsi_out$trace_comb)"},{"path":[]},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"pella-masuda-model","dir":"Articles","previous_headings":"Methods (math!)","what":"Pella-Masuda Model","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"integrated multistage GSI model essentially two Bayesian GSI models stacked top ; hence name “multistage.” Pella-Masuda model (Pella & Masuda 2001) Bayesian GSI model make stage integrated multistage model. first describe Pella-Masuda model discussing development integrated multistage model. group mixed populations, Pella-Masuda model assigns population identities individual based genetic make-(e.g. genotype). model estimates overall population proportions based numbers individuals assigned population. fishery context, genetic data individuals called mixture sample consists multi-locus genotype individual fish collected mixed-stock fishery. \\(\\mx x\\) denotes mixture sample. document, bold-font letter represents number set, collection distinct elements. example, \\(\\mx x\\) set contains individual \\(x\\) elements. \\(x_{m,l,j}\\) count allele \\(j\\) locus \\(l\\) individual fish \\(m\\), \\(m \\\\{1,2,...,M\\}\\), \\(l \\\\{1,2,...,L\\}\\), \\(j \\\\{1,2,...,J_l\\}\\) depends locus \\(l\\). Genetic data populations called baseline sample consists genotype compositions various baseline populations collected spawning locations. Researchers select sampling locations best represent populations area. \\(\\mx y\\) denotes baseline sample. \\(y_{k,l,j}\\) count allele \\(j\\) locus \\(l\\) sample size \\(n_{k,l}\\) collected baseline population \\(k\\), \\(k \\\\{1,2,...,K\\}\\). mixture baseline samples, assumed allele counts locus follow multinomial distribution3. Using another made-example, baseline sample, two allele types locus 1 population 2. Counts two alleles \\(y_{1,2,1}, y_{1,2,2}\\), follow multinomial distribution parameters \\(q_{1,2,1}, q_{1,2,2}\\) size \\(n_{2,1}\\). Note \\(q_{1,2,1}, q_{1,2,2}\\) relative frequencies two alleles locus 1 population 2. Bayesian framework, need specify prior distributions parameters; therefore, place Dirichlet4 prior distribution \\(q_{1,2,1}, q_{1,2,2}\\) hyperparameters5 \\(\\beta_{1,1}, \\beta_{1,2}\\). Usually set priors equal loci. example, let \\(\\beta_{1,1} = \\beta_{1,2} = 1/2\\) based number alleles locus 1. \\(\\mx q\\) represents \\(q_{1,2,1}\\) \\(q_{1,2,2}\\), together allele frequencies loci populations. can see, \\(\\mx q\\) \\(\\mx y\\) dimension relative frequency corresponds allele count. model, allele frequencies baseline populations, \\(\\mx q\\), determine population proportions. population proportions determines identities individual fish. Individual identities tallied summarized update baseline allele frequencies. \\(\\mx y\\) can expressed follows: \\(\\mx y_k \\sim Mult(\\mx n_k, \\mx q_k)\\) Prior distribution \\(\\mx q\\): \\(\\mx q_k \\sim Dirich(\\mx \\beta)\\), \\(\\mx \\beta = 1/J_l\\) mixture sample, allele counts locus individual fish also follows multinomial distributions. fish came certain population, distribution allele counts resemble allele frequencies baseline population came . However, identity individual fish unknown needs estimated. let \\(\\mx z_m\\) represent population identify \\(m\\)th mixture individual. \\(\\mx z_m\\) composed 0’s 1 length \\(K\\) (e.g. number baseline populations). \\(z_{m,k} = 1\\) individual \\(m\\) belongs population \\(k\\), \\(z_{m,k} = 0\\) otherwise. made-example, \\(\\mx z_{100} = \\{0, 0, 1, 0, 0\\}\\) means five baseline populations, individual fish #100 comes population 3. place multinomial prior \\(z_{m,1}, z_{m,2}, ..., z_{m,K}\\) size 1 probabilities equal population proportions \\(p_1, p_2, ..., p_K\\). specify Dirichlet prior distribution \\(p_1, p_2, ..., p_K\\) hyperparameters \\(\\alpha_1, \\alpha_2, ..., \\alpha_K\\), \\(\\alpha_1 = \\alpha_2 = ... = \\alpha_K = 1/K\\). usually set \\(\\alpha\\) equal reporting groups, can set based prior knowledge population proportions. express \\(\\mx z\\) follows: \\(\\mx z_m \\sim Mult(\\mx 1, \\mx p)\\) Prior distribution \\(\\mx p\\): \\(\\mx p \\sim Dirich(\\mx \\alpha)\\), \\(\\mx \\alpha = 1/K\\) mentioned, mixture sample, allele counts locus individual fish follows multinomial distributions. parameters allele frequencies corresponding baseline population size numbers ploidy respective locus. Remember population identity \\(z_{m,k} = 1\\) individual \\(m\\) belongs population \\(k\\), \\(z_{m,k} = 0\\) otherwise. multiplying population identities, \\(z_{m,1}, z_{m,2}, ..., z_{m,K}\\), allele frequencies baseline populations, \\(\\mx q_1, \\mx q_2, ..., \\mx q_K\\), allele frequencies baseline population individual \\(m\\) belong remain rest goes zero. \\(\\mx x\\) expressed . \\(\\mx{ploidy} = ploidy_1, ploidy_2, ..., ploidy_L\\) denotes ploidy locus. \\(\\mx x_m \\sim Mult(\\mx{ploidy}, \\mx z_m \\cdot \\mx q)\\) Moran Anderson (2018) implement genetic mixture analysis R package, rubias. program widely used researchers around world, including GCL. rubias utilizes model structure called conditional genetic stock identification model, conditional GSI model, modified Pella-Masuda model. main difference two models , conditional model, \\(\\mx q\\) integrated distribution mixture sample, \\(\\mx x_m\\). , baseline allele frequencies updated model. result , \\(\\mx x_m\\) takes form compound Dirichlet-multinomial distribution (Johnson el. 1997): \\(\\mx x_m \\sim CDM(\\mx{ploidy}, \\mx z_m \\cdot \\mx v)\\), \\(\\mx v\\) \\(\\mx \\beta + \\mx y\\). going attempt proving theory behind conditional model document (details can found Moran & Anderson 2018). since \\(\\mx q\\) integrated \\(\\mx x_m\\), process estimating parameters simpler streamlined. implemented conditional GSI stage integrated multistage model.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"extend-to-multistage","dir":"Articles","previous_headings":"Methods (math!)","what":"Extend to multistage","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"integrated multistage framework, two Pella-Masuda models connected fish assigned regional group second stage conditional based whether fish assigned reporting group regional baseline first stage. following describes conditional relationship broad-scale regional baselines: \\(\\mx z^{(regional)}_m | z^{(broad)}_m = \\begin{cases} \\mx z^{(regional)}_m & \\text{} z^{(broad)}_m = 1\\\\ \\mx 0 & \\text{otherwise} \\end{cases}\\) \\(\\mx z^{(regional)}_m\\) described previous section single stage scenario. vectors indicators (\\(0\\) \\(1\\)) identifying regional population individual \\(m\\) belongs . \\(z^{(broad)}_m\\) indicator well, \\(z^{(broad)}_m = 1\\) individual \\(m\\) belongs reporting group within regional baseline \\(0\\) otherwise. Combining \\(z^{(regional)}\\) \\(z^{(broad)}\\), \\(z^{(regional)}_{m,k} | z^{(broad)}_m = 1\\) individual \\(m\\) belongs reporting group within regional baseline assigned population \\(k\\) regional baseline. Individually, vectors \\(Z^{(regional)}_m\\) multinomial distribution, \\(Z^{(regional)}_m \\sim Mult(1, \\pi_m)\\), \\(\\pi_m\\) vectors probabilities individual \\(m\\) assigned regional reporting group. prior distribution \\(\\pi_m\\) Dirichlet, \\(Dirich(K^{-1})\\), \\(K\\) number reporting groups regional baseline. posterior distribution \\(\\pi_m|z^{(regional)}_m\\) also Dirichlet, \\(Dirich(\\sum_{m=1}^M z^{(regional)}_{m,1} + K^{-1}, \\sum_{m=1}^M z^{(regional)}_{m,2} + K^{-1},..., \\sum_{m=1}^M z^{(regional)}_{m,K} + K^{-1})\\). describe details deriving posteriors next section. context integrated multistage framework, care , first stage, whether individual assigned reporting group within regional baseline; therefore, individual identity binomial outcome, \\(Z^{(broad)}_m \\sim Bin(1, \\rho_m)\\). prior \\(\\rho_m\\) Beta distribution two scale parameters; one equals proportions broad-scale stocks regional baseline, equals proportions broad-scale stocks outside regional baseline. expectation \\(\\rho_m\\) equals proportion broad-scale stocks within regional baseline. posterior distribution \\(\\rho_m|z^{(broad)}_m\\) also Beta, first parameter equals sum individuals assigned broad-scale stock regional baseline proportion broad-scale stocks regional baseline, second parameter equals sum individuals assigned broad-scale stock outside regional baseline proportion broad-scale stocks outside regional baseline. Probability individual assigned regional population \\(k\\) can derived using Bayes rule: \\[\\begin{aligned} P&(Z^{(regional)}_{m,k} | Z^{(broad)}_m) =\\\\ &\\frac{P(Z^{(broad)}_m | Z^{(regional)}_{m,k}) \\cdot P(Z^{(regional)}_{m,k})} {\\sum_{k=1}^{K} P(Z^{(broad)}_m | Z^{(regional)}_{m,k}) \\cdot P(Z^{(regional)}_{m,k})} = \\frac{P(Z^{(broad)}_m) \\cdot P(Z^{(regional)}_{m,k})}{P(Z^{(broad)}_m)} \\end{aligned}\\] can simplified \\(P(Z^{(regional)}_{m,k})\\). GSI analysis, two Pella-Masuda models proceed tandem, baseline maker suite individuals mixture sample.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"gibbs-sampler-where-the-fun-go-round-and-round","dir":"Articles","previous_headings":"Methods (math!)","what":"Gibbs Sampler: where the fun go round and round","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"Deriving values parameters stage integrated multistage model requires finding joint posterior distribution Pella-Masuda model stage, \\(\\mx p, \\mx q,\\mx z, \\mx y, \\mx\\alpha, \\mx\\beta\\). section, introduce concepts algorithm sample posterior distribution single Pella-Masuda model, can extend integrated multistage framework. Gibbs sampler type MCMC methods sequentially sample parameter values Markov chain. enough sampling, Markov chain eventually converge desire distribution interest. appealing quality Gibbs sampler reduction multivariate problem (Pella-Masuda model) series manageable lower-dimensional problems. full description Gibbs sampler MCMC methods beyond scope document; however, information can found numerous resources devoting Bayesian data analysis (see Carlin & Louis 2009; Robert & Casella 2010; Gelman et al. 2014) illustrate, suppose like determine joint posterior distribution interest, \\(p(\\mx \\theta|\\mx y)\\), \\(\\mx \\theta = \\{\\theta_1, \\theta_2,..., \\theta_K\\}\\). likely multivariate \\(p(\\mx \\theta|\\mx y)\\) complicated sample . However, can figure break joint posterior distribution individual full conditional distributions, parameter \\(\\mx \\theta\\) can sampled one one sequentially using Gibbs sampler algorithm. process begins arbitrary set starting values \\(\\theta^{(0)}_2, \\theta^{(0)}_3,..., \\theta^{(0)}_K\\) proceeds follows: \\(t = 1,2,...,T\\), repeat Draw \\(\\theta^{(t)}_1\\) \\(p(\\theta_1|\\theta^{(t-1)}_2, \\theta^{(t-1)}_3,..., \\theta^{(t-1)}_k, \\mx y)\\) Draw \\(\\theta^{(t)}_2\\) \\(p(\\theta_2|\\theta^{(t)}_1, \\theta^{(t-1)}_3,..., \\theta^{(t-1)}_k, \\mx y)\\) ⋮ Draw \\(\\theta^{(t)}_k\\) \\(p(\\theta_k|\\theta^{(t)}_1, \\theta^{(t)}_2,..., \\theta^{(t)}_{k-1}, \\mx y)\\) work best full conditionals known distributions can easily sample (although ’s required). case Pella-Masuda model, rely two main concepts, Bayes theorem conjugacy, trick. Briefly, estimating parameters \\(\\mx\\theta\\) data \\(\\mx D\\), according Bayes Rule, \\(p(\\mx\\theta|\\mx D) = \\displaystyle \\frac{p(\\mx D|\\mx\\theta)p(\\mx\\theta)}{p(\\mx D)}\\). \\(p(\\mx\\theta|\\mx D)\\) joint posterior distribution parameters \\(\\mx\\theta\\), \\(p(\\mx D|\\mx\\theta)\\) likelihood observing data given parameters, \\(p(\\mx\\theta)\\) prior distribution parameters, \\(p(\\mx D)\\) constant marginal distribution data. \\(p(\\mx D)\\) often mathematically difficult obtain; however, \\(p(\\mx D)\\) constant number, can ignore reducing posterior distribution \\(p(\\mx\\theta|\\mx D) \\propto p(\\mx D|\\mx\\theta)p(\\mx\\theta)\\). , Bayes Rule help us estimating parameters Pella-Masuda model? First, joint posterior distribution split smaller pieces. , separate joint posterior likelihood data priors parameters: \\(p(\\mx p, \\mx q, \\mx z, \\mx y, \\mx\\alpha, \\mx\\beta)\\) \\(\\propto p(\\mx x|\\mx z, \\mx q) p(\\mx y|\\mx q) \\cdot p(\\mx p|\\mx\\alpha) p(\\mx q|\\mx\\beta) p(\\mx z|\\mx p)\\) re-arrangements hand-waving, arrive marginal posterior distributions \\(\\mx q\\) \\(\\mx p\\)$: \\(p(\\mx x|\\mx z, \\mx q) p(\\mx y|\\mx q) \\cdot p(\\mx p|\\mx\\alpha) p(\\mx q|\\mx\\beta) p(\\mx z|\\mx p)\\) \\(= p(\\mx x|\\mx z, \\mx q) p(\\mx y|\\mx q) p(\\mx q|\\mx\\beta) \\cdot p(\\mx z|\\mx p) p(\\mx p|\\mx\\alpha)\\) \\(\\propto p(\\mx x,\\mx y,\\mx z|\\mx q) p(\\mx q|\\mx\\beta) \\cdot p(\\mx z|\\mx p) p(\\mx p|\\mx\\alpha)\\) \\(\\propto p(\\mx q|\\mx x,\\mx y,\\mx z,\\mx\\beta) \\cdot p(\\mx p|\\mx z,\\mx\\alpha)\\) Next, take advantage mathematical property called conjugacy help us determine marginal posterior distributions. Based property, posterior distribution follows parametric form prior distribution prior conjugate family likelihood. example, likelihood data binomial distribution prior parameter beta distribution, posterior also beta distribution beta conjugate family binomial. many conjugate families, Dirichlet multinomial another example. Utilizing conjugacy property, determine marginal posterior distributions \\(\\mx q\\) \\(\\mx p\\).","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"marginal-posterior-pqx-y-z-beta","dir":"Articles","previous_headings":"Methods (math!) > Gibbs Sampler: where the fun go round and round","what":"Marginal Posterior p(q|x, y, z, \\(\\beta\\))","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"determine posterior \\(p(\\mx q|\\mx x,\\mx y,\\mx z,\\mx\\beta)\\) Dirichlet-distributed Dirichlet prior \\(p(\\mx q|\\mx\\beta)\\) conjugate family multinomial likelihoods \\(p(\\mx x|\\mx z, \\mx q)\\) \\(p(\\mx y|\\mx q)\\). determine exact parameterization posterior distribution, need derive prior likelihoods first. Likelihood \\(p(\\mx x|\\mx z, \\mx q)\\) can derived two steps. first step conditioned likelihood \\(\\mx z\\) \\(p(\\mx x|\\mx z, \\mx q) \\propto \\displaystyle \\prod^{M}_{m=1} \\prod^{K}_{k=1} [f(\\mx x_m|\\mx q_k)]^{z_{m,k}}\\), \\(f(\\mx x_m|\\mx q_k)\\) relative frequency multi-locus genotype individual \\(m\\) population \\(k\\). next step, derive \\(f(\\mx x_m|\\mx q_k)\\): \\(f(\\mx x_m|\\mx q_k) \\propto \\displaystyle \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{x_{m,l,j}}_{k,l,j}\\) combine two, \\(p(\\mx x|\\mx z, \\mx q) \\propto \\displaystyle \\prod^{M}_{m=1} \\prod^{K}_{k=1} [f(\\mx x_m|\\mx q_k)]^{z_{m,k}}\\) \\(\\propto \\displaystyle \\prod^{M}_{m=1} \\prod^{K}_{k=1} [\\displaystyle \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{x_{m,l,j} \\cdot z_{m,k}}_{k,l,j}]\\) \\(\\propto \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\sum^{M}_{m=1} (x_{m,l,j} \\cdot z_{m,k})}_{k,l,j}\\) Deriving likelihood \\(p(\\mx y|\\mx q)\\) straightforward. product relative frequency multi-locus genotype population: \\(p(\\mx y|\\mx q) \\propto \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{y_{k,l,j}}_{k,l,j}\\) \\(p(q|\\mx\\beta)\\) Dirichlet prior distribution. probability density kernel6 \\(\\mx q^{\\mx \\beta - 1}\\). can express likelihood \\(p(\\mx q|\\mx\\beta) \\propto \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\beta_{l,j} - 1}_{k,l,j}\\). Put likelihoods together, \\(p(\\mx q|\\mx x,\\mx y,\\mx z,\\mx\\beta) \\propto p(\\mx x|\\mx z, \\mx q) p(\\mx y|\\mx q) p(\\mx q|\\mx\\beta)\\) \\(\\propto \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\sum^{M}_{m=1} (x_{m,l,j} \\cdot z_{m,k})}_{k,l,j} \\cdot \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{y_{k,l,j}}_{k,l,j} \\cdot \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\beta_{l,j} - 1}_{k,l,j}\\) \\(= \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\sum^{M}_{m=1} (x_{m,l,j} \\cdot z_{m,k}) + y_{k,l,j} + \\beta_{l,j} - 1}_{k,l,j}\\) elementary anybody recognize \\(\\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\sum^{M}_{m=1} (x_{m,l,j} \\cdot z_{m,k}) + y_{k,l,j} + \\beta_{l,j} - 1}_{k,l,j}\\) kernel Dirichlet distribution. Hence, \\(\\mx q_{k,l}|\\mx x,\\mx y,\\mx z,\\mx\\beta \\sim Dirich(\\displaystyle \\sum^{M}_{m=1} x_{m,l,j} z_{m,k} + y_{k,l,j} + \\beta_{l,j})\\)","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"marginal-posterior-ppz-alpha","dir":"Articles","previous_headings":"Methods (math!) > Gibbs Sampler: where the fun go round and round","what":"Marginal Posterior p(p|z, \\(\\alpha\\))","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"Using logic previously, \\(p(\\mx p|\\mx z,\\mx\\alpha)\\) also Dirichlet-distributed due Dirichlet prior \\(p(\\mx p|\\mx\\alpha)\\) multinomial likelihood \\(p(\\mx z|\\mx p)\\). \\(p(\\mx p|\\mx z,\\mx\\alpha) \\propto p(\\mx z|\\mx p) p(\\mx p|\\mx\\alpha)\\) \\(\\propto \\displaystyle \\prod^{M}_{m=1} \\prod^{K}_{k=1} p^{z_{m,k}}_k \\cdot \\prod^{K}_{k=1} p^{\\alpha_k - 1}_k\\) \\(\\propto \\displaystyle \\prod^{K}_{k=1} p^{\\sum^M_{m=1}z_{m,k} + \\alpha_k - 1}_k\\) , recognize kernel Dirichlet distribution: \\(\\mx p|\\mx z,\\mx\\alpha \\sim Dirich(\\displaystyle \\sum^M_{m=1}z_{m,k} + \\alpha_k)\\)","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"algorithm","dir":"Articles","previous_headings":"Methods (math!) > Gibbs Sampler: where the fun go round and round","what":"Algorithm","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"one distribution figure can start Gibbs sampler routine (thought ’re set, lol). need know sample \\(\\mx z_m|\\mx p, \\mx q, \\mx x_m\\), population identity individual fish \\(m\\) (components 1 2) given population proportions genotype. probability fish \\(m\\) belong population \\(k\\) \\(p_k\\), likelihood observing relative frequency genotype fish \\(m\\) population \\(k\\) \\(f(\\mx x_m|\\mx q_k)\\), probability fish \\(m\\) belong population \\(k\\) given population proportions genotype \\(\\displaystyle \\frac{p_k \\cdot f(\\mx x_m|\\mx q_k)}{\\sum^K_{k'=1}p_{k'} \\cdot f(\\mx x_m|\\mx q_{k'})}\\). denominator sum one, need calculate numerator. \\(\\mx z_m|\\mx p, \\mx q, \\mx x_m\\) following distribution: \\(\\mx z_m|\\mx p, \\mx q, \\mx x_m \\sim Mult(1, \\mx{p'}_m)\\), \\(p'_{m,k} = p_k \\cdot f(\\mx x_m|\\mx q_k)\\). draw initial values \\(\\mx q_k\\) based prior distribution. figured pieces Gibbs sampler, may begin process starting values \\(\\mx p^{(0)}\\) \\(\\mx q^{(0)}\\). proceed follows: \\(t = 1,2,...,T\\), repeat Determine population identity mixture individuals, \\(\\mx z^{(t)}_m|\\mx p^{(t-1)}, \\mx q^{(t-1)}, \\mx x_m \\sim Mult(1, \\mx{p'}_m)\\). Draw marginal posterior distributions \\(\\mx q^{(t)}\\) \\(\\mx p^{(t)}\\) \\(p(\\mx q|\\mx x,\\mx y,\\mx z^{(t)},\\mx\\beta)\\) \\(p(\\mx p|\\mx z^{(t)},\\mx\\alpha)\\) respectively. \\(T\\) large enough ensure sampler chain converges desire distribution interest. Usually takes thousands iterations. extend algorithm multistage: Determine population identities mixture individuals first stage, \\(\\mx z^{(broad)(t)}_m|\\mx p^{(broad)(t-1)}, \\mx q^{(broad)(t-1)}, \\mx x_m \\sim Mult(1, \\mx{p'}^{(broad)}_m)\\). Determine population identities mixture individuals second stage, \\(\\mx z^{(regional)(t)}_m|z^{(broad)(t)}_m, \\mx p^{(regional)(t-1)}, \\mx q^{(regional)(t-1)}, \\mx x_m \\sim Mult(1, \\mx{p'}^{(regional)}_m)\\). Draw marginal posterior distributions \\(\\mx q^{(broad)(t)}\\), \\(\\mx p^{(broad)(t)}\\), \\(\\mx q^{(regional)(t)}\\) \\(\\mx p^{(regional)(t)}\\) \\(p(\\mx q^{(broad)}|\\mx x,\\mx y^{(broad)},\\mx z^{(broad)(t)},\\mx\\beta^{(broad)})\\), \\(p(\\mx p^{(broad)}|\\mx z^{(broad)(t)},\\mx\\alpha^{(broad)})\\), \\(p(\\mx q^{(regional)}|\\mx x,\\mx y^{(regional)},\\mx z^{(regional)(t)},\\mx\\beta^{(regional)})\\) \\(p(\\mx p^{(regional)}|\\mx z^{(regional)(t)},\\mx\\alpha^{(regional)})\\) respectively. Steps 1 3 repeated simulations converge desire distribution. Implementing conditional GSI model requires slight modification algorithm. first stage, \\(f(\\mx x_m|\\mx q^{(broad)}_k)\\) need derived beginning process, \\(\\mx q^{(broad)}\\) longer updated step 3. second stage, \\(\\mx x_m\\) changes depending outcome \\(z^{(broad)}_m\\); therefore, \\(f(\\mx x_m|\\mx q^{(regional)}_k)\\) recalculated. However, \\(\\mx q^{(regional)}\\) need updated. Everything else algorithm stays .","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"*Ms.GSI* in the multistage of genetic stock identification madness","text":"Brooks, S. P., . Gelman. 1998. General methods monitoring convergence iterative simulations. Journal Computational Graphical Statistics. 7:434–455. Carlin, B. T. Louis. 2009. Bayesian Methods Data Analysis, 3rd Edition. CRC Press. New York. Gelman, ., D. B. Rubin. 1992. Inference iterative simulation using multiple sequences. Statistical Science. 7:457–472. Gelman, ., J. Carlin, H. Stern, D. Dunson, . Vehtari D. Rubin. 2014. Bayesian Data Analysis, 3rd Edition. CRC Press. New York. Johnson, N.L., Kotz, S., Balakrishnan, N. 1997. Discrete multivariate distributions. Wiley & Sons, New York. Lee. E., T. Dann, H. Hoyt. 2021. Yukon River Chinook Genetic Baseline Improvements. Yukon River Panel Restoration Enhancement Fund Final Report, URE-163-19N. Moran, B.M. E.C. Anderson. 2018. Bayesian inference conditional genetic stock identification model. Canadian Journal Fisheries Aquatic Sciences. 76(4):551-560. https://doi.org/10.1139/cjfas-2018-0016 Pella, J. M. Masuda. 2001. Bayesian methods analysis stock mixtures genetic characters. Fish. Bull. 99:151–167. Robert, C. G. Casella. 2010. Introducing Monte Carlo Methods R. Springer. New York. Templin, W. D., J. E. Seeb, J. R. Jasper, . W. Barclay, L. W. Seeb. 2011. Genetic differentiation Alaska Chinook salmon: missing link migratory studies. Mol Ecol Resour. 11(Suppl 1):226-246. doi:10.1111/j.1755-0998.2010.02968.x.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Bobby Hsu. Author, maintainer. Alaska Dept. Fish & Game. Copyright holder.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hsu B (2023). Ms.GSI: Multistage Genetic Stock Identification. https://github.com/boppingshoe/Ms.GSI, https://boppingshoe.github.io/Ms.GSI/.","code":"@Manual{,   title = {Ms.GSI: Multistage Genetic Stock Identification},   author = {Bobby Hsu},   year = {2023},   note = {https://github.com/boppingshoe/Ms.GSI, https://boppingshoe.github.io/Ms.GSI/}, }"},{"path":"https://boppingshoe.github.io/Ms.GSI/index.html","id":"msgsi-","dir":"","previous_headings":"","what":"Multistage Genetic Stock Identification","title":"Multistage Genetic Stock Identification","text":"Ms.GSI help conducting multistage genetic stock identification. package includes functions setup input data, run multistage model, make summary statistics convergence diagnostics. also includes function making trace plots.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Multistage Genetic Stock Identification","text":"can install development version Ms.GSI GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"boppingshoe/Ms.GSI\", build_vignettes = TRUE)"},{"path":"https://boppingshoe.github.io/Ms.GSI/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Multistage Genetic Stock Identification","text":"example shows basic workflows running multistage model. First thing first, background: made scenario samples Chinook salmon bycatch Bering Sea groundfish fisheries. mixture sample contains Chinook North Pacific, interested contribution Yukon River. conduct GSI using broad-scale baseline (base_templin) combination regional baseline (base_yukon) multistage framework. fake Chinook data sets pre-loaded Ms.GSI package. prepare input data: Using prepared input data, run model four chains 150 iterations. reality, course run iterations. set first 50 iterations chain warm-ups (kept final output). ’s summary estimates convergence diagnostics. ’s function package make trace plots inspect mixing chains.  Details mathematical model integrated multistage framework instructions using Ms.GSI package can found “articles” tab package website. , installed Ms.GSI, can call article using vignette(\"msgsi_vignette\").","code":"library(Ms.GSI)  msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 11.39952 secs msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 150, nburn = 50, thin = 1, nchains = 4) #> Running model (and the category is... Butch Queen Body!) #> Time difference of 13.52093 secs #> June-08-2023 15:50  msgsi_out$summ_comb #> # A tibble: 12 × 8 #>    group                       mean  median      sd    ci.05   ci.95    GR n_eff #>    <chr>                      <dbl>   <dbl>   <dbl>    <dbl>   <dbl> <dbl> <dbl> #>  1 Russia                   2.54e-2 2.14e-2 0.0176  3.43e- 3 0.0602   1.01 121.  #>  2 Coastal West Alaska      2.91e-1 3.01e-1 0.0949  1.04e- 1 0.429    1.29  50.1 #>  3 North Alaska Peninsula   2.51e-2 1.95e-2 0.0258  2.40e-14 0.0723   1.22  60.7 #>  4 Northwest Gulf of Alaska 3.57e-1 3.50e-1 0.0936  2.18e- 1 0.546    1.31  57.7 #>  5 Copper                   5.81e-4 1.72e-6 0.00169 6.22e-19 0.00348  1.05 309.  #>  6 Northeast Gulf of Alaska 2.76e-3 3.06e-6 0.00946 5.57e-19 0.0168   1.16 139.  #>  7 Coastal Southeast Alaska 1.31e-3 7.94e-7 0.00415 2.12e-19 0.00914  1.09 218.  #>  8 British Columbia         7.41e-4 1.80e-6 0.00234 4.36e-17 0.00489  1.07 294.  #>  9 WA/OR/CA                 6.46e-4 1.15e-6 0.00170 9.89e-19 0.00364  1.03 400   #> 10 Lower Yukon              6.41e-2 5.44e-2 0.0375  1.87e- 2 0.136    1.13  94.1 #> 11 Middle Yukon             6.39e-2 6.01e-2 0.0221  3.19e- 2 0.103    1.00 574.  #> 12 Upper Yukon              1.68e-1 1.66e-1 0.0321  1.16e- 1 0.223    1.02 335. tr_plot(obj = msgsi_out$trace_comb)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_templin.html","id":null,"dir":"Reference","previous_headings":"","what":"Templin baseline data. — base_templin","title":"Templin baseline data. — base_templin","text":"example genotype data preparing msgsi input data rubias format (prep_msgsi_data() can also take GCL format) making road-scale baseline","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_templin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Templin baseline data. — base_templin","text":"","code":"base_templin"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_templin.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Templin baseline data. — base_templin","text":"tibble 29363 rows 60 variables:","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_templin.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Templin baseline data. — base_templin","text":"ADF&G GCL database LOKI","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_yukon.html","id":null,"dir":"Reference","previous_headings":"","what":"Yukon baseline data. — base_yukon","title":"Yukon baseline data. — base_yukon","text":"example genotype data preparing msgsi input data rubias format (prep_msgsi_data() can also take GCL format) making regional, finer-scale baseline","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_yukon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Yukon baseline data. — base_yukon","text":"","code":"base_yukon"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_yukon.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Yukon baseline data. — base_yukon","text":"tibble 5435 rows 358 variables:","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_yukon.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Yukon baseline data. — base_yukon","text":"ADF&G GCL database LOKI","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":null,"dir":"Reference","previous_headings":"","what":"Individual assignment summary — indiv_assign","title":"Individual assignment summary — indiv_assign","text":"Individual assignment summary","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Individual assignment summary — indiv_assign","text":"","code":"indiv_assign(mdl_out, mdl_dat)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Individual assignment summary — indiv_assign","text":"mdl_out Model output object name. mdl_dat Input data object name.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Individual assignment summary — indiv_assign","text":"Individual assignment summary","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Individual assignment summary — indiv_assign","text":"","code":"# set up input data and run multistage model msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 13.80293 secs  msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 25, nburn = 15, thin = 1, nchains = 1) #> Running model (and the category is... Once Upon A Time!) #> Time difference of 1.788727 secs #> June-08-2023 23:55  # trace plot ind_iden <- indiv_assign(msgsi_out, msgsi_dat)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/mix.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixture data. — mix","title":"Mixture data. — mix","text":"example genotype data preparing msgsi input data rubias format (prep_msgsi_data() can also take GCL format) making mixed population data made mixture sample, real","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/mix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixture data. — mix","text":"","code":"mix"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/mix.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mixture data. — mix","text":"tibble 150 rows 358 variables:","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/mix.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mixture data. — mix","text":"ADF&G GCL database LOKI","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":null,"dir":"Reference","previous_headings":"","what":"Run multistage GSI model — msgsi_mdl","title":"Run multistage GSI model — msgsi_mdl","text":"Run multistage GSI model","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run multistage GSI model — msgsi_mdl","text":"","code":"msgsi_mdl(   dat_in,   nreps,   nburn,   thin,   nchains,   nadapt = 0,   keep_burn = FALSE,   cond_gsi = TRUE,   out_path = NULL,   seed = NULL,   iden_output = TRUE )"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run multistage GSI model — msgsi_mdl","text":"dat_in Name input data. nreps Total number iterations (includes burn-ins). nburn Number warm-runs. thin Frequency thin output. nchains Number independent MCMC processes. nadapt Number adaptation run (default 0). available running model fully Bayesian mode. keep_burn save burn-ins (default FALSE). cond_gsi run model conditional GSI mode (default TRUE). out_path File path save output. Leave empty want save output. seed Random seed reproducibility. Default NULL (random seed). iden_output Option trace history individual assignments included final output. Default TRUE.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run multistage GSI model — msgsi_mdl","text":"list contains reporting group proportion summary trace tier 1 (summ_t1, trace_t1), tier 2 (summ_t2, trace_t2) two tiers combined (summ_comb, trace_comb), record individual assignment first tier individual (idens).","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run multistage GSI model — msgsi_mdl","text":"","code":"# setup input data msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 12.94806 secs  # run multistage model msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 25, nburn = 15, thin = 1, nchains = 1) #> Running model (and the category is... Higher Than Heaven!) #> Time difference of 1.710624 secs #> June-08-2023 23:56"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Preparing multistage GSI input data — prep_msgsi_data","title":"Preparing multistage GSI input data — prep_msgsi_data","text":"Preparing multistage GSI input data","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preparing multistage GSI input data — prep_msgsi_data","text":"","code":"prep_msgsi_data(   mixture_data,   baseline1_data,   baseline2_data,   pop1_info,   pop2_info,   sub_group,   file_path = NULL,   loci1 = NULL,   loci2 = NULL )"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preparing multistage GSI input data — prep_msgsi_data","text":"mixture_data Individual fish loci tier 1 tier 2. Mixture data GCL rubias format. baseline1_data Tier 1 baseline data GCL rubias format. baseline2_data Tier 2 baseline data GCL rubias format. pop1_info Population information tier 1. tibble columns collection (collection names), repunit (reporting unit names), grpvec (group numbers), origin (wild/hatchery). pop2_info Population information tier 2. tibble columns collection (collection names), repunit (reporting unit names), grpvec (group numbers). sub_group Group numbers groups interest. Group id numbers tier 1 identify groups tier 2. file_path want save copy input data. Leave empty want save copy. loci1 Optional. Provide loci (tier 1) fail-safe check. loci2 Optional. Provide loci (tier 2) fail-safe check.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preparing multistage GSI input data — prep_msgsi_data","text":"list objects input data msgsi_mdl()","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Preparing multistage GSI input data — prep_msgsi_data","text":"","code":"msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 12.80627 secs"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/templin_pops211.html","id":null,"dir":"Reference","previous_headings":"","what":"Templin population infomation. — templin_pops211","title":"Templin population infomation. — templin_pops211","text":"tibble contains collection name, reporting unit, group number 211 populations Templin baseline","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/templin_pops211.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Templin population infomation. — templin_pops211","text":"","code":"templin_pops211"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/templin_pops211.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Templin population infomation. — templin_pops211","text":"tibble 211 rows 3 variables: collection, repunit, grpvec","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot MCMC trace — tr_plot","title":"Plot MCMC trace — tr_plot","text":"Plot MCMC trace","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot MCMC trace — tr_plot","text":"","code":"tr_plot(obj, nburn = 0, thin = 1, name_order = NULL)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot MCMC trace — tr_plot","text":"obj Trace model output. nburn Number burn-set ran model. Default 0 save burn-ins (keep_burn = FALSE). thin Number thinning set ran model. Default 1 (thinning). name_order Arrange reporting groups wish. Leave empty want accept default.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot MCMC trace — tr_plot","text":"Trace plot ggplot","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot MCMC trace — tr_plot","text":"","code":"# set up input data and run multistage model msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 12.63859 secs  msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 25, nburn = 15, thin = 1, nchains = 1) #> Running model (and the category is... Lofting!) #> Time difference of 1.709138 secs #> June-08-2023 23:56  # trace plot tr_plot(obj = msgsi_out$trace_comb)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/yukon_pops50.html","id":null,"dir":"Reference","previous_headings":"","what":"Yukon population infomation. — yukon_pops50","title":"Yukon population infomation. — yukon_pops50","text":"tibble contains collection name, reporting unit, group number 50 populations Yukon River baseline","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/yukon_pops50.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Yukon population infomation. — yukon_pops50","text":"","code":"yukon_pops50"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/yukon_pops50.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Yukon population infomation. — yukon_pops50","text":"tibble 50 rows 3 variables: collection, repunit, grpvec","code":""}]
