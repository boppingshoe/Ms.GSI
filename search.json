[{"path":"https://boppingshoe.github.io/Ms.GSI/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Ms.GSI authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"document contains background information integrated multistage genetic stock identification (GSI) model two parts. first part describes use package Ms.GSI conduct GSI analysis. steps include formatting input data, running integrated multistage GSI model, summarizing results. second part details technical background integrated multistage GSI model mathematical theory. separate article describe general background integrated multistage framework (add link integrated multistage paper).","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"how-to-use-ms-gsi","dir":"Articles","previous_headings":"","what":"How to use Ms.GSI","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"Ms.GSI follows work flow: format input data, run integrated multistage model, summarize results/convergence diagnostics.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"input-data","dir":"Articles","previous_headings":"How to use Ms.GSI","what":"Input data","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"pieces information needed input data set: broad-scale baseline regional baseline mixture sample broad-scale population information regional population information pre-loaded example data sets available Ms.GSI. look one time. Note example data sets simulated using existing baseline archived Alaska Department Fish & Game Gene Conservation Lab (GCL). fabricated data set represent true population proportions real fisheries. example, made scenario similar Bering Sea groundfish fisheries Chinook salmon harvested bycatch originated wide range geographic areas. Within bycatch sample, interested proportion contribution lower, middle upper Yukon River reporting groups (see map ). used coast-wide data set Chinook salmon (Templin et al.¬†2011; Templin baseline hereafter) broad-scale baseline separate Yukon River fish non-Yukon stocks data set first stage analysis. However, genetic markers Templin baseline unable clearly distinguish lower Yukon River coastal western Alaska populations, used second baseline additional genetic markers specifically designed differentiate Yukon River Chinook salmon populations (Lee et al.¬†2021; Yukon River baseline hereafter) regional fine-scale baseline second stage. important note original grouping Templin baseline, Lower Yukon part Coastal Western Alaska reporting group. isolated Lower Yukon rest Coastal Western Alaska, accuracy proportion estimates likely diminish breakup Coastal Western Alaska reporting group. recommend using genetic baseline beyond original design. researchers aware capability genetic baselines utilizing integrated multistage model. example, ideal keep Coastal Western Alaska group intact broad-scale baseline, break group Lower Yukon others using fine-scale regional baseline. However, time writing, regional baseline adequate resolution still development. assembled mixture sample containing 150 individuals collection sites across Yukon River, coastal western Alaskan, Alaska Peninsula, Gulf Alaska, Kamchatka Peninsula (Russia). collections grouped five reporting groups: Lower Yukon, Middle Yukon, Upper Yukon, Coastal Western Alaska (Coastal West Alaska), Others.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"mixture","dir":"Articles","previous_headings":"How to use Ms.GSI > Input data","what":"Mixture","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"First take look baseline mixture samples. Ms.GSI accepts genotype information two format: 1) GCL format 2) package rubias format. example data sets rubias format naming convention, procedures GCL format same1. Columns 5 358 contain genotype information loci broad-scale regional baselines. specify loci baseline (can want double check, later). Ms.GSI matches loci mixture baselines long locus names consistent. fish known-origin, can specify identities adding column called known_collection mixture data set. entry known-origin match collection name broad-scale baseline. Fish unknown-origin NA entry.","code":"print(dplyr::as_tibble(mix)) #> # A tibble: 150 √ó 358 #>    sample_type repunit collection indiv   `GTH2B-550` `GTH2B-550.1` NOD1  NOD1.1 #>    <chr>       <lgl>   <chr>      <chr>   <chr>       <chr>         <chr> <chr>  #>  1 mixture     NA      Bering Sea fish_1  C           G             C     C      #>  2 mixture     NA      Bering Sea fish_2  C           C             C     G      #>  3 mixture     NA      Bering Sea fish_3  C           C             C     G      #>  4 mixture     NA      Bering Sea fish_4  C           C             C     C      #>  5 mixture     NA      Bering Sea fish_5  C           G             C     G      #>  6 mixture     NA      Bering Sea fish_6  C           C             C     G      #>  7 mixture     NA      Bering Sea fish_7  C           C             NA    NA     #>  8 mixture     NA      Bering Sea fish_8  C           G             NA    NA     #>  9 mixture     NA      Bering Sea fish_9  C           G             C     G      #> 10 mixture     NA      Bering Sea fish_10 C           G             NA    NA     #> # ‚Ñπ 140 more rows #> # ‚Ñπ 350 more variables: `Ots_100884-287` <chr>, `Ots_100884-287.1` <chr>, #> #   `Ots_101554-407` <chr>, `Ots_101554-407.1` <chr>, `Ots_102414-395` <chr>, #> #   `Ots_102414-395.1` <chr>, `Ots_102867-609` <chr>, `Ots_102867-609.1` <chr>, #> #   `Ots_103041-52` <chr>, `Ots_103041-52.1` <chr>, `Ots_103122-180` <chr>, #> #   `Ots_103122-180.1` <chr>, `Ots_104048-194` <chr>, `Ots_104048-194.1` <chr>, #> #   `Ots_104063-132` <chr>, `Ots_104063-132.1` <chr>, `Ots_104415-88` <chr>, ‚Ä¶"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"broad-scale-baseline","dir":"Articles","previous_headings":"How to use Ms.GSI > Input data","what":"Broad-scale baseline","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"Next, take look broad-scale (Templin) baseline example provided Ms.GSI. originally 45 loci Templin baseline, reduced marker set 28 loci due limitation data size (technical reasons). However, demonstration purpose, data set suffice.","code":"print(dplyr::as_tibble(base_templin)) #> # A tibble: 29,363 √ó 60 #>    sample_type repunit collection indiv   `GTH2B-550` `GTH2B-550.1` NOD1  NOD1.1 #>    <chr>       <chr>   <chr>      <chr>   <chr>       <chr>         <chr> <chr>  #>  1 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           C             C     G      #>  2 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           G             C     G      #>  3 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           G             C     G      #>  4 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           C             G     G      #>  5 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           G             G     G      #>  6 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           C             C     C      #>  7 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           G             C     G      #>  8 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           C             C     G      #>  9 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           G             C     G      #> 10 reference   Russia  KBIST98L   KBIST9‚Ä¶ C           C             G     G      #> # ‚Ñπ 29,353 more rows #> # ‚Ñπ 52 more variables: `Ots_2KER-137` <chr>, `Ots_2KER-137.1` <chr>, #> #   `Ots_AsnRS-72` <chr>, `Ots_AsnRS-72.1` <chr>, Ots_ETIF1A <chr>, #> #   Ots_ETIF1A.1 <chr>, `Ots_GPH-318` <chr>, `Ots_GPH-318.1` <chr>, #> #   `Ots_GST-207` <chr>, `Ots_GST-207.1` <chr>, `Ots_hnRNPL-533` <chr>, #> #   `Ots_hnRNPL-533.1` <chr>, `Ots_HSP90B-100` <chr>, `Ots_HSP90B-100.1` <chr>, #> #   `Ots_IGF1-91` <chr>, `Ots_IGF1-91.1` <chr>, `Ots_IK1-328` <chr>, ‚Ä¶"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"regional-baseline","dir":"Articles","previous_headings":"How to use Ms.GSI > Input data","what":"Regional baseline","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"regional baseline (Yukon) format. originally 380 loci Yukon River Chinook baseline, reduced numbers 177 demonstration.","code":"print(dplyr::as_tibble(base_yukon)) #> # A tibble: 5,435 √ó 358 #>    sample_type repunit   collection indiv `GTH2B-550` `GTH2B-550.1` NOD1  NOD1.1 #>    <chr>       <chr>     <chr>      <chr> <chr>       <chr>         <chr> <chr>  #>  1 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ G           G             C     C      #>  2 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ C           G             C     C      #>  3 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ G           G             C     C      #>  4 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ G           G             C     G      #>  5 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ C           G             C     C      #>  6 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ C           C             C     C      #>  7 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ C           G             G     G      #>  8 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ C           C             G     G      #>  9 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ C           C             G     G      #> 10 reference   Lower Yu‚Ä¶ KANDR02.K‚Ä¶ KAND‚Ä¶ C           G             C     G      #> # ‚Ñπ 5,425 more rows #> # ‚Ñπ 350 more variables: `Ots_100884-287` <chr>, `Ots_100884-287.1` <chr>, #> #   `Ots_101554-407` <chr>, `Ots_101554-407.1` <chr>, `Ots_102414-395` <chr>, #> #   `Ots_102414-395.1` <chr>, `Ots_102867-609` <chr>, `Ots_102867-609.1` <chr>, #> #   `Ots_103041-52` <chr>, `Ots_103041-52.1` <chr>, `Ots_103122-180` <chr>, #> #   `Ots_103122-180.1` <chr>, `Ots_104048-194` <chr>, `Ots_104048-194.1` <chr>, #> #   `Ots_104063-132` <chr>, `Ots_104063-132.1` <chr>, `Ots_104415-88` <chr>, ‚Ä¶"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"population-information","dir":"Articles","previous_headings":"How to use Ms.GSI > Input data","what":"Population information","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"Another piece information needed population details baseline. need include three columns population information table. Column collection contains names population baseline. Column reunit specifies reporting group population belongs . Column grpvec specifies identification number reporting group. shows first ten rows population information Templin (broad-scale) baseline. hatchery populations mixture sample, can tell Ms.GSI either collection belongs natural hatchery-origin adding origin column population information table. origin column, identify collection \"wild\" \"hatchery\". don‚Äôt care separate natural hatchery origins, can lump one collection. case, don‚Äôt need add origin column. Also, option identify hatchery fish available broad-scale baseline, don‚Äôt add origin column population table regional baseline. Population information table Yukon (regional) baseline format, necessarily order. data files ready (recommend saving .Rdata .Rds files), can use prep_msgsi_data() function convert input data set model run. ‚Äôll also need identify ‚Äúgroups interest‚Äù parameter sub-group. example, groups interests Lower Yukon, Middle Yukon Upper Yukon reporting groups. identify numbers 3, 4, 5 broad-scale baseline. ‚Äôs option save input data designated directory identifying location parameter file_path. prep_msgsi_data() function matches loci mixture baselines. want make sure didn‚Äôt miss locus baselines mixture, can manually provide loci names (string vector) baseline inputting loci1 loci2. example don‚Äôt manually provide lists loci trust mixture baselines correct loci. prep_msgsi_data() formats data files put list. took seconds format input data case. Bigger data sets may take longer. first rows/items input data list:","code":"print(dplyr::as_tibble(templin_pops211)) #> # A tibble: 211 √ó 3 #>    collection       repunit             grpvec #>    <chr>            <chr>                <dbl> #>  1 KBIST98L         Russia                   1 #>  2 KBOLS02.KBOLS98E Russia                   1 #>  3 KKAMC97.KKAMC98L Russia                   1 #>  4 KPAKH02          Russia                   1 #>  5 KPILG05.KPILG06  Coastal West Alaska      2 #>  6 KUNAL05          Coastal West Alaska      2 #>  7 KGOLS05.KGOLS06  Coastal West Alaska      2 #>  8 KANDR02.KANDR03  Lower Yukon              3 #>  9 KANVI02          Lower Yukon              3 #> 10 KGISA01          Lower Yukon              3 #> # ‚Ñπ 201 more rows print(dplyr::as_tibble(yukon_pops50)) #> # A tibble: 50 √ó 3 #>    collection                          grpvec repunit      #>    <chr>                                <dbl> <chr>        #>  1 KANDR02.KANDR03                          1 Lower Yukon  #>  2 KANVI03.KANVI07                          1 Lower Yukon  #>  3 KNUL12SF                                 1 Lower Yukon  #>  4 KNUL12NF                                 1 Lower Yukon  #>  5 KGISA01                                  1 Lower Yukon  #>  6 KKATE02.KKATE12                          1 Lower Yukon  #>  7 KHENS01                                  2 Middle Yukon #>  8 KHENS07.KHENS15                          2 Middle Yukon #>  9 KSFKOY03                                 2 Middle Yukon #> 10 KMFKOY10.KMFKOY11.KMFKOY12.KMFKOY13      2 Middle Yukon #> # ‚Ñπ 40 more rows msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 9.460528 secs lapply(msgsi_dat, head) #> $x #> # A tibble: 6 √ó 57 #>   indiv    `GTH2B-550_1` `GTH2B-550_2` NOD1_1 NOD1_2 `Ots_2KER-137_1` #>   <chr>            <int>         <int>  <int>  <int>            <int> #> 1 fish_1               1             1      2      0                0 #> 2 fish_10              1             1      0      0                1 #> 3 fish_100             1             1      1      1                1 #> 4 fish_101             1             1      1      1                1 #> 5 fish_102             0             2      0      2                0 #> 6 fish_103             2             0      1      1                1 #> # ‚Ñπ 51 more variables: `Ots_2KER-137_2` <int>, `Ots_AsnRS-72_1` <int>, #> #   `Ots_AsnRS-72_2` <int>, Ots_ETIF1A_1 <int>, Ots_ETIF1A_2 <int>, #> #   `Ots_GPH-318_1` <int>, `Ots_GPH-318_2` <int>, `Ots_GST-207_1` <int>, #> #   `Ots_GST-207_2` <int>, `Ots_HSP90B-100_1` <int>, `Ots_HSP90B-100_2` <int>, #> #   `Ots_IGF1-91_1` <int>, `Ots_IGF1-91_2` <int>, `Ots_IK1-328_1` <int>, #> #   `Ots_IK1-328_2` <int>, `Ots_LEI-292_1` <int>, `Ots_LEI-292_2` <int>, #> #   Ots_MHC1_1 <int>, Ots_MHC1_2 <int>, `Ots_OPLW-173_1` <int>, ‚Ä¶ #>  #> $x2 #> # A tibble: 6 √ó 355 #>   indiv    `GTH2B-550_1` `GTH2B-550_2` NOD1_1 NOD1_2 `Ots_100884-287_1` #>   <chr>            <int>         <int>  <int>  <int>              <int> #> 1 fish_1               1             1      2      0                  2 #> 2 fish_10              1             1      0      0                  0 #> 3 fish_100             1             1      1      1                  1 #> 4 fish_101             1             1      1      1                  2 #> 5 fish_102             2             0      0      2                  1 #> 6 fish_103             0             2      1      1                  1 #> # ‚Ñπ 349 more variables: `Ots_100884-287_2` <int>, `Ots_101554-407_1` <int>, #> #   `Ots_101554-407_2` <int>, `Ots_102414-395_1` <int>, #> #   `Ots_102414-395_2` <int>, `Ots_102867-609_1` <int>, #> #   `Ots_102867-609_2` <int>, `Ots_103041-52_1` <int>, `Ots_103041-52_2` <int>, #> #   `Ots_103122-180_1` <int>, `Ots_103122-180_2` <int>, #> #   `Ots_104048-194_1` <int>, `Ots_104048-194_2` <int>, #> #   `Ots_104063-132_1` <int>, `Ots_104063-132_2` <int>, ‚Ä¶ #>  #> $y #> # A tibble: 6 √ó 59 #>   collection            repunit grpvec `GTH2B-550_1` `GTH2B-550_2` NOD1_1 NOD1_2 #>   <chr>                 <chr>    <dbl>         <int>         <int>  <int>  <int> #> 1 CHBIG92.KIBIG93.KBIG‚Ä¶ Northe‚Ä¶      9           254            82    104    228 #> 2 CHCRY92.KICRY94.KCRY‚Ä¶ Coasta‚Ä¶     10           306           302    120    488 #> 3 CHDMT92.KDEER94       Coasta‚Ä¶     10           178           116     77    217 #> 4 CHKAN92.KIKAN93.KKAN‚Ä¶ Coasta‚Ä¶      2           341           147    281    199 #> 5 CHKOG92.KIKOG93.KKOG‚Ä¶ Coasta‚Ä¶      2           205            91    191    105 #> 6 CHNUU92.KINUS93       Coasta‚Ä¶      2            85            27     73     41 #> # ‚Ñπ 52 more variables: `Ots_2KER-137_1` <int>, `Ots_2KER-137_2` <int>, #> #   `Ots_AsnRS-72_1` <int>, `Ots_AsnRS-72_2` <int>, Ots_ETIF1A_1 <int>, #> #   Ots_ETIF1A_2 <int>, `Ots_GPH-318_1` <int>, `Ots_GPH-318_2` <int>, #> #   `Ots_GST-207_1` <int>, `Ots_GST-207_2` <int>, `Ots_HSP90B-100_1` <int>, #> #   `Ots_HSP90B-100_2` <int>, `Ots_IGF1-91_1` <int>, `Ots_IGF1-91_2` <int>, #> #   `Ots_IK1-328_1` <int>, `Ots_IK1-328_2` <int>, `Ots_LEI-292_1` <int>, #> #   `Ots_LEI-292_2` <int>, Ots_MHC1_1 <int>, Ots_MHC1_2 <int>, ‚Ä¶ #>  #> $y2 #> # A tibble: 6 √ó 357 #>   collection            grpvec repunit `GTH2B-550_1` `GTH2B-550_2` NOD1_1 NOD1_2 #>   <chr>                  <dbl> <chr>           <int>         <int>  <int>  <int> #> 1 CHSID92j                   3 Upper ‚Ä¶             7           183    116     74 #> 2 K100MILECR16.K100MIL‚Ä¶      3 Upper ‚Ä¶             7           103     78     34 #> 3 KANDR02.KANDR03            1 Lower ‚Ä¶            78           230    208    100 #> 4 KANVI03.KANVI07            1 Lower ‚Ä¶            62           164    131     79 #> 5 KBEAV97                    2 Middle‚Ä¶            40           148    152     38 #> 6 KBIGS87.KBIGS07            3 Upper ‚Ä¶            30           258    231     65 #> # ‚Ñπ 350 more variables: `Ots_100884-287_1` <int>, `Ots_100884-287_2` <int>, #> #   `Ots_101554-407_1` <int>, `Ots_101554-407_2` <int>, #> #   `Ots_102414-395_1` <int>, `Ots_102414-395_2` <int>, #> #   `Ots_102867-609_1` <int>, `Ots_102867-609_2` <int>, #> #   `Ots_103041-52_1` <int>, `Ots_103041-52_2` <int>, `Ots_103122-180_1` <int>, #> #   `Ots_103122-180_2` <int>, `Ots_104048-194_1` <int>, #> #   `Ots_104048-194_2` <int>, `Ots_104063-132_1` <int>, ‚Ä¶ #>  #> $iden #> NULL #>  #> $nalleles #>    GTH2B-550         NOD1 Ots_2KER-137 Ots_AsnRS-72   Ots_ETIF1A  Ots_GPH-318  #>            2            2            2            2            2            2  #>  #> $nalleles2 #>      GTH2B-550           NOD1 Ots_100884-287 Ots_101554-407 Ots_102414-395  #>              2              2              2              2              2  #> Ots_102867-609  #>              2  #>  #> $groups #> # A tibble: 6 √ó 3 #>   collection                      repunit                  grpvec #>   <chr>                           <chr>                     <dbl> #> 1 CHBIG92.KIBIG93.KBIGB04.KBIGB95 Northeast Gulf of Alaska      9 #> 2 CHCRY92.KICRY94.KCRYA05         Coastal Southeast Alaska     10 #> 3 CHDMT92.KDEER94                 Coastal Southeast Alaska     10 #> 4 CHKAN92.KIKAN93.KKANE05         Coastal West Alaska           2 #> 5 CHKOG92.KIKOG93.KKOGR05         Coastal West Alaska           2 #> 6 CHNUU92.KINUS93                 Coastal West Alaska           2 #>  #> $p2_groups #> # A tibble: 6 √ó 3 #>   collection                repunit      grpvec #>   <chr>                     <chr>         <dbl> #> 1 CHSID92j                  Upper Yukon       3 #> 2 K100MILECR16.K100MILECR15 Upper Yukon       3 #> 3 KANDR02.KANDR03           Lower Yukon       1 #> 4 KANVI03.KANVI07           Lower Yukon       1 #> 5 KBEAV97                   Middle Yukon      2 #> 6 KBIGS87.KBIGS07           Upper Yukon       3 #>  #> $comb_groups #> # A tibble: 6 √ó 3 #>   collection                      repunit                  grpvec #>   <chr>                           <chr>                     <dbl> #> 1 CHBIG92.KIBIG93.KBIGB04.KBIGB95 Northeast Gulf of Alaska      9 #> 2 CHCRY92.KICRY94.KCRYA05         Coastal Southeast Alaska     10 #> 3 CHDMT92.KDEER94                 Coastal Southeast Alaska     10 #> 4 CHKAN92.KIKAN93.KKANE05         Coastal West Alaska           2 #> 5 CHKOG92.KIKOG93.KKOGR05         Coastal West Alaska           2 #> 6 CHNUU92.KINUS93                 Coastal West Alaska           2 #>  #> $sub_group #> [1] 3 4 5 #>  #> $group_names_t1 #> [1] \"Russia\"                 \"Coastal West Alaska\"    \"Lower Yukon\"            #> [4] \"Middle Yukon\"           \"Upper Yukon\"            \"North Alaska Peninsula\" #>  #> $group_names_t2 #> [1] \"Lower Yukon\"  \"Middle Yukon\" \"Upper Yukon\"  #>  #> $wildpops #> [1] \"CHBIG92.KIBIG93.KBIGB04.KBIGB95\" \"CHCRY92.KICRY94.KCRYA05\"         #> [3] \"CHDMT92.KDEER94\"                 \"CHKAN92.KIKAN93.KKANE05\"         #> [5] \"CHKOG92.KIKOG93.KKOGR05\"         \"CHNUU92.KINUS93\"                 #>  #> $hatcheries #> NULL"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"genetic-stock-identification","dir":"Articles","previous_headings":"How to use Ms.GSI","what":"Genetic stock identification","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"input data set ready, can use msgsi_mdl() run model. used running rubias, Ms.GSI might feel bit slow. 1) running two GSI models tandem, takes twice long running single model, 2) Ms.GSI written solely R, computationally efficient language C. , code Ms.GSI C? ‚Äôre technically advanced like folks developed rubias package (.e., don‚Äôt know code C++). running time, recommend running integrated multistage model conditional GSI mode (default setting). option run model fully Bayesian mode one choose . run model fully Bayesian mode, option include numbers adaptation run. people think adaptation run encourages convergence fully Bayesian mode. test theory provide option want try . demonstrate model run one chains 150 iterations (first 50 warm-runs, burn-ins). run one chain example can pass CMD check building vignette document2. reality, definitely run multiple chains iterations. also options keep burn-ins set random seed reproducible results. don‚Äôt show example though (can always ?msgsi_mdl).","code":"msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 150, nburn = 50, thin = 1, nchains = 1) #> Running model (and the category is... Linen Vs. Silk!) #> Time difference of 2.250802 secs #> May-22-2025 20:42"},{"path":[]},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"stock-proportions","dir":"Articles","previous_headings":"How to use Ms.GSI > Summarizing results","what":"Stock proportions","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"output model contains nine items: summ_t1, trace_t1, summ_t2, trace_t2, summ_comb, trace_comb, comb_groups, comb_groups, iden_t1 idens_t2. Items ‚Äúsumm‚Äù summary reporting group proportions associated convergence diagnostics. want see summaries stage one two individually, summ_t1 summ_t2 show . people probably want see combined summary, summ_comb. column names self explanatory, others might need additional descriptions. ci.05 ci.95 lower upper bounds 90% credible interval. p0 probability estimate equals zero. estimate p0 calculating portion posterior samples less 5√ó10‚àí75 \\times 10^{-7}. GR Gelman-Rubin statistic (.k.. RÃÇ\\hat R). example, Gelman-Rubin statistic calculated run one chain. n_eff effective size, NeffN_{eff}. discuss diagnose convergence document. Please consult Gelman et al.¬†2014, Gelman & Rubin 1992, Brooks & Gelman 1998 literature statistical methods. Items ‚Äútrace‚Äù posterior sample history, trace history, either stage one, two, combined. Trace history needed making trace plots. need combine reporting groups proportions combine variance, trace histories need. trace_ items tibbles collection column. two additional columns, itr chain, identify Markov chain Monte Carlo (MCMC) sampling iteration chain. comb_groups provided output reference functions making trace plots (tr_plot()) stratified estimator (stratified_estimator_msgsi()). Grouping stage one two can also found input data.","code":"msgsi_out$summ_comb #> # A tibble: 12 √ó 9 #>    group                mean  median      sd    ci.05   ci.95    p0 GR     n_eff #>    <chr>               <dbl>   <dbl>   <dbl>    <dbl>   <dbl> <dbl> <lgl>  <dbl> #>  1 Russia            5.21e-2 4.82e-2 0.0203  2.29e- 2 0.0857   0    NA     45.4  #>  2 Coastal West Ala‚Ä¶ 7.27e-2 7.15e-2 0.0560  2.55e-12 0.179    0.12 NA      7.96 #>  3 North Alaska Pen‚Ä¶ 3.59e-2 3.45e-2 0.0197  1.11e- 2 0.0720   0    NA     29.1  #>  4 Northwest Gulf o‚Ä¶ 3.10e-1 3.10e-1 0.0593  2.14e- 1 0.410    0    NA     23.2  #>  5 Copper            1.50e-3 6.36e-6 0.00398 3.16e-21 0.00856  0.39 NA     67.8  #>  6 Northeast Gulf o‚Ä¶ 1.38e-3 6.74e-7 0.00424 1.53e-16 0.00783  0.48 NA     59.2  #>  7 Coastal Southeas‚Ä¶ 6.10e-4 1.70e-6 0.00202 4.02e-16 0.00296  0.44 NA    100    #>  8 British Columbia  5.57e-4 3.83e-7 0.00214 2.25e-19 0.00245  0.5  NA    100    #>  9 WA/OR/CA          6.68e-4 1.32e-5 0.00161 2.55e-17 0.00413  0.38 NA    100    #> 10 Lower Yukon       2.56e-1 2.60e-1 0.0645  1.56e- 1 0.358    0    NA     17.2  #> 11 Middle Yukon      7.60e-2 7.59e-2 0.0222  4.66e- 2 0.122    0    NA    100    #> 12 Upper Yukon       1.93e-1 1.88e-1 0.0321  1.42e- 1 0.240    0    NA    100 msgsi_out$trace_comb #> # A tibble: 100 √ó 238 #>    CHBIG92.KIBIG93.KBIGB04.KBIGB95 CHCRY92.KICRY94.KCRYA05 CHDMT92.KDEER94 #>                              <dbl>                   <dbl>           <dbl> #>  1                       2.65e-  3               3.74e-223       8.74e- 41 #>  2                       1.49e-  2               9.40e- 82       1.64e- 39 #>  3                       4.62e-  3               1.47e-102       9.82e- 99 #>  4                       3.60e-125               2.03e- 34       2.85e-176 #>  5                       2.80e- 38               7.29e- 58       2.79e- 72 #>  6                       7.57e- 87               9.73e-231       3.04e- 24 #>  7                       7.36e- 27               7.77e- 22       3.52e-  8 #>  8                       1.16e- 47               1.75e-164       3.04e-154 #>  9                       9.03e- 29               1.23e-245       2.33e- 17 #> 10                       1.61e- 40               4.42e-320       2.06e- 22 #> # ‚Ñπ 90 more rows #> # ‚Ñπ 235 more variables: CHKAN92.KIKAN93.KKANE05 <dbl>, #> #   CHKOG92.KIKOG93.KKOGR05 <dbl>, CHNUU92.KINUS93 <dbl>, #> #   CHTAH92.KTAHI04 <dbl>, CHWHI92.KWHIT98.KWHITC05 <dbl>, KALSE04 <dbl>, #> #   KANCH06.KANCH10 <dbl>, KANDR89.KANDR04 <dbl>, KAROL05 <dbl>, #> #   KBENJ05.KBENJ06 <dbl>, KBIGCK04 <dbl>, KBIGQU96 <dbl>, #> #   KBIRK01.KBIRK02.KBIRK03.KBIRK97.KBIRK99 <dbl>, KBIST98L <dbl>, ‚Ä¶"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"individual-assignments","dir":"Articles","previous_headings":"How to use Ms.GSI > Summarizing results","what":"Individual assignments","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"last two items output identity assignment history individual mixture sample. column represents individual mixture, row records identity assigned iteration chain. numbers population identifiers order population information files (baseline files). Individuals ordered input data (.e., mixture data). Individual identity output format may useful users. , Ms.GSI function indiv_assign() summarize reporting group assignment probabilities individual mixture. summary individual assignment column named ID identifies individual mixture. reporting groups represent combined grouping broad regional baselines. Probabilities row sum one.","code":"msgsi_out$idens_t1 #> # A tibble: 100 √ó 150 #>       V1    V2    V3    V4    V5    V6    V7    V8    V9   V10   V11   V12   V13 #>    <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> #>  1   200   200    11    97    97   125    97   101   101   114    11   157    11 #>  2   200    32    21    87   114    11    97    32   200   114    97   200   200 #>  3   200    11    21    87   101   125    97    87    97   114    11   200    11 #>  4    11   200    21    87   101    11    97   200    11   114    11   200    11 #>  5    11    11    21    32   101   125    97   200    97   101    11    11    11 #>  6    87    97    21    87    32   125    97    32   101    87    11    32   200 #>  7    11    87    21    11   101   125    97    32   200   114    11   157    11 #>  8    32    21    21    87    87   125    97    87    97   114    97    11    11 #>  9    87    87    21    87   200   125    97    32    32   114    87   101    11 #> 10   200    97    21   101    97   200    97    87    32    87    11    97   200 #> # ‚Ñπ 90 more rows #> # ‚Ñπ 137 more variables: V14 <int>, V15 <int>, V16 <int>, V17 <int>, V18 <int>, #> #   V19 <int>, V20 <int>, V21 <int>, V22 <int>, V23 <int>, V24 <int>, #> #   V25 <int>, V26 <int>, V27 <int>, V28 <int>, V29 <int>, V30 <int>, #> #   V31 <int>, V32 <int>, V33 <int>, V34 <int>, V35 <int>, V36 <int>, #> #   V37 <int>, V38 <int>, V39 <int>, V40 <int>, V41 <int>, V42 <int>, #> #   V43 <int>, V44 <int>, V45 <int>, V46 <int>, V47 <int>, V48 <int>, ‚Ä¶ indiv_assign(mdl_out = msgsi_out, mdl_dat = msgsi_dat) #> # A tibble: 150 √ó 13 #>    ID       Russia `Coastal West Alaska` `North Alaska Peninsula` #>  * <chr>     <dbl>                 <dbl>                    <dbl> #>  1 fish_1     0                     0.31                     0    #>  2 fish_10    0.11                  0.07                     0.05 #>  3 fish_100   0.96                  0                        0    #>  4 fish_101   0                     0.05                     0.01 #>  5 fish_102   0                     0.03                     0.06 #>  6 fish_103   0                     0.01                     0    #>  7 fish_104   0                     0                        0    #>  8 fish_105   0                     0.1                      0    #>  9 fish_106   0                     0.15                     0    #> 10 fish_107   0                     0                        0.62 #> # ‚Ñπ 140 more rows #> # ‚Ñπ 9 more variables: `Northwest Gulf of Alaska` <dbl>, Copper <dbl>, #> #   `Northeast Gulf of Alaska` <dbl>, `Coastal Southeast Alaska` <dbl>, #> #   `British Columbia` <dbl>, `WA/OR/CA` <dbl>, `Lower Yukon` <dbl>, #> #   `Middle Yukon` <dbl>, `Upper Yukon` <dbl>"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"trace-plot","dir":"Articles","previous_headings":"How to use Ms.GSI > Summarizing results","what":"Trace plot","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"Ms.GSI function make trace plot examine mixing MCMC chains. Don‚Äôt forget include group information (groups, p2_groups, comb_groups) trace history want plot. Trace plots reporting group proportions.","code":"tr_plot(obj = msgsi_out$trace_comb, pop_info = msgsi_out$comb_groups)"},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"stratified-estimator","dir":"Articles","previous_headings":"How to use Ms.GSI > Summarizing results","what":"Stratified estimator","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"stratified_estimator-msgsi() function combines stock group estimates multiple mixtures (.e., strata) weighted harvest numbers fishing efforts. designed work way stratified_estimator_rubias() function GCLr package GCL, although input format slightly different. , save Ms.GSI output mixture separate folder preferred directory, specify path stratified_estimator_rubias(path = ...). stratified_estimator-msgsi() can also combine variances different sources single mixture. , want convert total harvest number (CV provided) harvest individual reporting groups, stratified_estimator-msgsi() can . case, use example model output new grouping:","code":"new_groups <- msgsi_out$summ_comb |>   dplyr::select(group) |>   dplyr::mutate(new_repunit = c(rep(\"Broad\", 9), rep(\"Regional\", 3))) |>   dplyr::rename(repunit = group)  stratified_estimator_msgsi(mdl_out = msgsi_out, mixvec = \"Bering example\",                            catchvec = 500, cv = 0.1, new_pop_info = new_groups) #> # A tibble: 2 √ó 12 #>   repunit  mean_harv sd_harv median_harv ci05_harv ci95_harv  mean     sd median #>   <chr>        <dbl>   <dbl>       <dbl>     <dbl>     <dbl> <dbl>  <dbl>  <dbl> #> 1 Broad         235.    42.5        231.      175.      311. 0.475 0.0645  0.475 #> 2 Regional      258.    38.7        253.      202.      327. 0.525 0.0645  0.525 #> # ‚Ñπ 3 more variables: ci05 <dbl>, ci95 <dbl>, `P=0` <dbl>"},{"path":[]},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"pella-masuda-model","dir":"Articles","previous_headings":"Methods (math!)","what":"Pella-Masuda Model","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"integrated multistage GSI model essentially two Bayesian GSI models stacked top ; hence name ‚Äúmultistage.‚Äù Pella-Masuda model (Pella & Masuda 2001) Bayesian GSI model make stage integrated multistage model. first describe Pella-Masuda model discussing development integrated multistage model. group mixed populations, Pella-Masuda model assigns population identities individual based genetic make-(e.g.¬†genotype). model estimates overall population proportions based numbers individuals assigned population. fishery context, genetic data individuals called mixture sample consists multi-locus genotype individual fish collected mixed-stock fishery. ùê±\\mathbf x denotes mixture sample. document, bold-font letter represents number set, collection distinct elements. example, ùê±\\mathbf x set contains individual xx elements. xm,l,jx_{m,l,j} count allele jj locus ll individual fish mm, m‚àà{1,2,...,M}m \\\\{1,2,...,M\\}, l‚àà{1,2,...,L}l \\\\{1,2,...,L\\}, j‚àà{1,2,...,Jl}j \\\\{1,2,...,J_l\\} depends locus ll. Genetic data populations called baseline sample consists genotype compositions various baseline populations collected spawning locations. Researchers select sampling locations best represent populations area. ùê≤\\mathbf y denotes baseline sample. yk,l,jy_{k,l,j} count allele jj locus ll sample size nk,ln_{k,l} collected baseline population kk, k‚àà{1,2,...,K}k \\\\{1,2,...,K\\}. mixture baseline samples, assumed allele counts locus follow multinomial distribution3. Using another made-example, baseline sample, two allele types locus 1 population 2. Counts two alleles y1,2,1,y1,2,2y_{1,2,1}, y_{1,2,2}, follow multinomial distribution parameters q1,2,1,q1,2,2q_{1,2,1}, q_{1,2,2} size n2,1n_{2,1}. Note q1,2,1,q1,2,2q_{1,2,1}, q_{1,2,2} relative frequencies two alleles locus 1 population 2. Bayesian framework, need specify prior distributions parameters; therefore, place Dirichlet4 prior distribution q1,2,1,q1,2,2q_{1,2,1}, q_{1,2,2} hyperparameters5 Œ≤1,1,Œ≤1,2\\beta_{1,1}, \\beta_{1,2}. Usually set priors equal loci. example, let Œ≤1,1=Œ≤1,2=1/2\\beta_{1,1} = \\beta_{1,2} = 1/2 based number alleles locus 1. ùê™\\mathbf q represents q1,2,1q_{1,2,1} q1,2,2q_{1,2,2}, together allele frequencies loci populations. can see, ùê™\\mathbf q ùê≤\\mathbf y dimension relative frequency corresponds allele count. model, allele frequencies baseline populations, ùê™\\mathbf q, determine population proportions. population proportions determines identities individual fish. Individual identities tallied summarized update baseline allele frequencies. ùê≤\\mathbf y can expressed follows: ùê≤k‚àºMult(ùêßk,ùê™k)\\mathbf y_k \\sim Mult(\\mathbf n_k, \\mathbf q_k) Prior distribution ùê™\\mathbf q: ùê™k‚àºDirich(ùõÉ)\\mathbf q_k \\sim Dirich(\\mathbf \\beta), ùõÉ=1/Jl\\mathbf \\beta = 1/J_l mixture sample, allele counts locus individual fish also follows multinomial distributions. fish came certain population, distribution allele counts resemble allele frequencies baseline population came . However, identity individual fish unknown needs estimated. let ùê≥m\\mathbf z_m represent population identify mmth mixture individual. ùê≥m\\mathbf z_m composed 0‚Äôs 1 length KK (e.g.¬†number baseline populations). zm,k=1z_{m,k} = 1 individual mm belongs population kk, zm,k=0z_{m,k} = 0 otherwise. made-example, ùê≥100={0,0,1,0,0}\\mathbf z_{100} = \\{0, 0, 1, 0, 0\\} means five baseline populations, individual fish #100 comes population 3. place multinomial prior zm,1,zm,2,...,zm,Kz_{m,1}, z_{m,2}, ..., z_{m,K} size 1 probabilities equal population proportions p1,p2,...,pKp_1, p_2, ..., p_K. specify Dirichlet prior distribution p1,p2,...,pKp_1, p_2, ..., p_K hyperparameters Œ±1,Œ±2,...,Œ±K\\alpha_1, \\alpha_2, ..., \\alpha_K, Œ±1=Œ±2=...=Œ±K=1/K\\alpha_1 = \\alpha_2 = ... = \\alpha_K = 1/K. usually set Œ±\\alpha equal reporting groups, can set based prior knowledge population proportions. express ùê≥\\mathbf z follows: ùê≥m‚àºMult(ùüè,ùê©)\\mathbf z_m \\sim Mult(\\mathbf 1, \\mathbf p) Prior distribution ùê©\\mathbf p: ùê©‚àºDirich(ùõÇ)\\mathbf p \\sim Dirich(\\mathbf \\alpha), ùõÇ=1/K\\mathbf \\alpha = 1/K mentioned, mixture sample, allele counts locus individual fish follows multinomial distributions. parameters allele frequencies corresponding baseline population size numbers ploidy respective locus. Remember population identity zm,k=1z_{m,k} = 1 individual mm belongs population kk, zm,k=0z_{m,k} = 0 otherwise. multiplying population identities, zm,1,zm,2,...,zm,Kz_{m,1}, z_{m,2}, ..., z_{m,K}, allele frequencies baseline populations, ùê™1,ùê™2,...,ùê™K\\mathbf q_1, \\mathbf q_2, ..., \\mathbf q_K, allele frequencies baseline population individual mm belong remain rest goes zero. ùê±\\mathbf x expressed . ùê©ùê•ùê®ùê¢ùêùùê≤=ploidy1,ploidy2,...,ploidyL\\mathbf{ploidy} = ploidy_1, ploidy_2, ..., ploidy_L denotes ploidy locus. ùê±m‚àºMult(ùê©ùê•ùê®ùê¢ùêùùê≤,ùê≥m‚ãÖùê™)\\mathbf x_m \\sim Mult(\\mathbf{ploidy}, \\mathbf z_m \\cdot \\mathbf q) Moran Anderson (2018) implement genetic mixture analysis R package, rubias. program widely used researchers around world, including GCL. rubias utilizes model structure called conditional genetic stock identification model, conditional GSI model, modified Pella-Masuda model. main difference two models , conditional model, ùê™\\mathbf q integrated distribution mixture sample, ùê±m\\mathbf x_m. , baseline allele frequencies updated model. result , ùê±m\\mathbf x_m takes form compound Dirichlet-multinomial distribution (Johnson el. 1997): ùê±m‚àºCDM(ùê©ùê•ùê®ùê¢ùêùùê≤,ùê≥m‚ãÖùêØ)\\mathbf x_m \\sim CDM(\\mathbf{ploidy}, \\mathbf z_m \\cdot \\mathbf v), ùêØ\\mathbf v ùõÉ+ùê≤\\mathbf \\beta + \\mathbf y. going attempt proving theory behind conditional model document (details can found Moran & Anderson 2018). since ùê™\\mathbf q integrated ùê±m\\mathbf x_m, process estimating parameters simpler streamlined. implemented conditional GSI stage integrated multistage model.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"extend-to-multistage","dir":"Articles","previous_headings":"Methods (math!)","what":"Extend to multistage","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"multistage setting, refer baseline covers whole range mixed stock fishery broad-scale baseline. broad-scale baseline typically covers wide range geographic areas comprehensive collection reference populations genetic markers resolve differences local populations within sub-region. smaller sub-regions broad-scale baseline covered regional baselines higher resolutions. generalize conditions Ms.GSI model allow multiple regional baselines included, although programmed Ms.GSI deal one regional baseline vs.¬†one broad-scale baseline. Let BB populations broad-scale baseline indexed b=1,2,...,Bb = 1, 2, ..., B. broad-scale populations may belong exactly 0 1 sub-region regional baselines might available. regional baselines different sets genetic markers broad-scale baseline typically include additional populations represented broad-scale baseline. Allow RR disjoint sub-regions indexed rr, sub-region represented distinctive regional baseline. employ superscript (r)^{(r)} upon variables indicate quantity associated regional baseline rr. Populations different sub-regions overlap, population occurs among regional baselines. Let kk index populations within RR regional baselines KrK_r denotes number populations within regional baseline rr. Ms.GSI framework, two stages connected regional group membership individual conditional whether broad-scale group membership individual belongs area particular sub-region. following describes conditional relationship broad-scale regional baselines: ùê≥m(r)|ùê≥m,‚Ñ¨(r)={ùê≥m(r)‚àëb‚àà‚Ñ¨(r)zm,b=1ùüéotherwise\\mathbf z^{(r)}_m | \\mathbf z_m, \\mathbf {\\mathscr B}^{(r)} = \\begin{cases} \\mathbf z^{(r)}_m & \\text{} \\sum_{b \\\\mathbf{\\mathscr B}^{(r)}} z_{m,b}  = 1\\\\ \\mathbf 0 & \\text{otherwise} \\end{cases}, ùê≥m\\mathbf z_m ùê≥m(r)\\mathbf z^{(r)}_m vectors indicators (00 11) identifying broad-scale regional populations individual mm belongs . ‚Ñ¨(r)\\mathbf{\\mathscr B}^{(r)} denotes broad-scale populations belong areas represented reporting groups region rr, ùüé\\mathbf 0 vector zeros. Ultimately, want estimate fraction individuals mixture come sub-regional populations, well populations broad-scale baseline associated regional baseline. pk(r)p^{(r)}_k denotes mixture proportion kkth population region rr, pbp_b denotes mixture proportion population bb broad-scale baseline. Thus, endeavor estimate mixture proportions pk(r)p^{(r)}_k (r,k)(r, k) r=1,2,...,Rr = 1, 2, ..., R k=1,2,...,Krk = 1, 2, ..., K_r along pbp_b, b‚àà‚Ñ¨*b \\\\mathbf{\\mathscr B_{*}}, ‚Ñ¨*\\mathbf{\\mathscr B_{*}} denoting broad-scale populations belong areas represented regional baselines. Lastly, multiply ùê©(r)\\mathbf {p}^{(r)} ‚àëb‚àà‚Ñ¨(r)pb\\sum_{b \\\\mathbf{\\mathscr B}^{(r)}} p_b region rr, scaled ùê©(r)\\mathbf{p}^{(r)} regions pbp_b, b‚àà‚Ñ¨*b \\\\mathbf{\\mathscr B_{*}} sum one.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"gibbs-sampler-where-the-fun-go-round-and-round","dir":"Articles","previous_headings":"Methods (math!)","what":"Gibbs Sampler: where the fun go round and round","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"Deriving values parameters stage integrated multistage model requires finding joint posterior distribution Pella-Masuda model stage, ùê©,ùê™,ùê≥,ùê≤,ùõÇ,ùõÉ\\mathbf p, \\mathbf q,\\mathbf z, \\mathbf y, \\mathbf\\alpha, \\mathbf\\beta. section, introduce concepts algorithm sample posterior distribution single baseline Pella-Masuda model, can extend integrated multistage framework. Gibbs sampler type MCMC methods sequentially sample parameter values Markov chain. enough sampling, Markov chain eventually converge desire distribution interest. appealing quality Gibbs sampler reduction multivariate problem (Pella-Masuda model) series manageable lower-dimensional problems. full description Gibbs sampler MCMC methods beyond scope document; however, information can found numerous resources devoting Bayesian data analysis (see Carlin & Louis 2009; Robert & Casella 2010; Gelman et al.¬†2014) illustrate, suppose like determine joint posterior distribution interest, p(ùõâ|ùê≤)p(\\mathbf \\theta|\\mathbf y), ùõâ={Œ∏1,Œ∏2,...,Œ∏K}\\mathbf \\theta = \\{\\theta_1, \\theta_2,..., \\theta_K\\}. likely multivariate p(ùõâ|ùê≤)p(\\mathbf \\theta|\\mathbf y) complicated sample . However, can figure break joint posterior distribution individual full conditional distributions, parameter ùõâ\\mathbf \\theta can sampled one one sequentially using Gibbs sampler algorithm. process begins arbitrary set starting values Œ∏2(0),Œ∏3(0),...,Œ∏K(0)\\theta^{(0)}_2, \\theta^{(0)}_3,..., \\theta^{(0)}_K proceeds follows: t=1,2,...,Tt = 1,2,...,T, repeat Draw Œ∏1(t)\\theta^{(t)}_1 p(Œ∏1|Œ∏2(t‚àí1),Œ∏3(t‚àí1),...,Œ∏k(t‚àí1),ùê≤)p(\\theta_1|\\theta^{(t-1)}_2, \\theta^{(t-1)}_3,..., \\theta^{(t-1)}_k, \\mathbf y) Draw Œ∏2(t)\\theta^{(t)}_2 p(Œ∏2|Œ∏1(t),Œ∏3(t‚àí1),...,Œ∏k(t‚àí1),ùê≤)p(\\theta_2|\\theta^{(t)}_1, \\theta^{(t-1)}_3,..., \\theta^{(t-1)}_k, \\mathbf y) ‚ãÆ Draw Œ∏k(t)\\theta^{(t)}_k p(Œ∏k|Œ∏1(t),Œ∏2(t),...,Œ∏k‚àí1(t),ùê≤)p(\\theta_k|\\theta^{(t)}_1, \\theta^{(t)}_2,..., \\theta^{(t)}_{k-1}, \\mathbf y) work best full conditionals known distributions can easily sample (although ‚Äôs required). case Pella-Masuda model, rely two main concepts, Bayes theorem conjugacy, trick. Briefly, estimating parameters ùõâ\\mathbf\\theta data ùêÉ\\mathbf D, according Bayes Rule, p(ùõâ|ùêÉ)=p(ùêÉ|ùõâ)p(ùõâ)p(ùêÉ)p(\\mathbf\\theta|\\mathbf D) = \\displaystyle \\frac{p(\\mathbf D|\\mathbf\\theta)p(\\mathbf\\theta)}{p(\\mathbf D)}. p(ùõâ|ùêÉ)p(\\mathbf\\theta|\\mathbf D) joint posterior distribution parameters ùõâ\\mathbf\\theta, p(ùêÉ|ùõâ)p(\\mathbf D|\\mathbf\\theta) likelihood observing data given parameters, p(ùõâ)p(\\mathbf\\theta) prior distribution parameters, p(ùêÉ)p(\\mathbf D) constant marginal distribution data. p(ùêÉ)p(\\mathbf D) often mathematically difficult obtain; however, p(ùêÉ)p(\\mathbf D) constant number, can ignore reducing posterior distribution p(ùõâ|ùêÉ)‚àùp(ùêÉ|ùõâ)p(ùõâ)p(\\mathbf\\theta|\\mathbf D) \\propto p(\\mathbf D|\\mathbf\\theta)p(\\mathbf\\theta). , Bayes Rule help us estimating parameters Pella-Masuda model? First, joint posterior distribution split smaller pieces. , separate joint posterior likelihood data priors parameters: p(ùê©,ùê™,ùê≥,ùê≤,ùõÇ,ùõÉ)p(\\mathbf p, \\mathbf q, \\mathbf z, \\mathbf y, \\mathbf\\alpha, \\mathbf\\beta) ‚àùp(ùê±|ùê≥,ùê™)p(ùê≤|ùê™)‚ãÖp(ùê©|ùõÇ)p(ùê™|ùõÉ)p(ùê≥|ùê©)\\propto p(\\mathbf x|\\mathbf z, \\mathbf q) p(\\mathbf y|\\mathbf q) \\cdot p(\\mathbf p|\\mathbf\\alpha) p(\\mathbf q|\\mathbf\\beta) p(\\mathbf z|\\mathbf p) re-arrangements hand-waving, arrive full conditional distributions ùê™\\mathbf q ùê©\\mathbf p: p(ùê±|ùê≥,ùê™)p(ùê≤|ùê™)‚ãÖp(ùê©|ùõÇ)p(ùê™|ùõÉ)p(ùê≥|ùê©)p(\\mathbf x|\\mathbf z, \\mathbf q) p(\\mathbf y|\\mathbf q) \\cdot p(\\mathbf p|\\mathbf\\alpha) p(\\mathbf q|\\mathbf\\beta) p(\\mathbf z|\\mathbf p) =p(ùê±|ùê≥,ùê™)p(ùê≤|ùê™)p(ùê™|ùõÉ)‚ãÖp(ùê≥|ùê©)p(ùê©|ùõÇ)= p(\\mathbf x|\\mathbf z, \\mathbf q) p(\\mathbf y|\\mathbf q) p(\\mathbf q|\\mathbf\\beta) \\cdot p(\\mathbf z|\\mathbf p) p(\\mathbf p|\\mathbf\\alpha) ‚àùp(ùê±,ùê≤,ùê≥|ùê™)p(ùê™|ùõÉ)‚ãÖp(ùê≥|ùê©)p(ùê©|ùõÇ)\\propto p(\\mathbf x,\\mathbf y,\\mathbf z|\\mathbf q) p(\\mathbf q|\\mathbf\\beta) \\cdot p(\\mathbf z|\\mathbf p) p(\\mathbf p|\\mathbf\\alpha) ‚àùp(ùê™|ùê±,ùê≤,ùê≥,ùõÉ)‚ãÖp(ùê©|ùê≥,ùõÇ)\\propto p(\\mathbf q|\\mathbf x,\\mathbf y,\\mathbf z,\\mathbf\\beta) \\cdot p(\\mathbf p|\\mathbf z,\\mathbf\\alpha) Next, take advantage mathematical property called conjugacy help us determine conditional distributions. Based property, posterior distribution follows parametric form prior distribution prior conjugate family likelihood. example, likelihood data binomial distribution prior parameter beta distribution, posterior also beta distribution beta conjugate family binomial. many conjugate families, Dirichlet multinomial another example. Utilizing conjugacy property, determine full conditional distributions ùê™\\mathbf q ùê©\\mathbf p.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"conditional-distribution-pqx-y-z-beta","dir":"Articles","previous_headings":"Methods (math!) > Gibbs Sampler: where the fun go round and round","what":"Conditional distribution p(q|x, y, z, Œ≤\\beta)","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"determine p(ùê™|ùê±,ùê≤,ùê≥,ùõÉ)p(\\mathbf q|\\mathbf x, \\mathbf y, \\mathbf z, \\mathbf \\beta) Dirichlet-distributed Dirichlet prior p(ùê™|ùõÉ)p(\\mathbf q|\\mathbf \\beta) conjugate family multinomial likelihoods p(ùê±|ùê≥,ùê™)p(\\mathbf x|\\mathbf z, \\mathbf q) p(ùê≤|ùê™)p(\\mathbf y|\\mathbf q). determine exact parameterization posterior distribution, need derive prior likelihoods first. Likelihood p(ùê±|ùê≥,ùê™)p(\\mathbf x|\\mathbf z, \\mathbf q) can derived two steps. first step conditioned likelihood ùê≥\\mathbf z p(ùê±|ùê≥,ùê™)‚àù‚àèm=1M‚àèk=1K[f(ùê±m|ùê™k)]zm,kp(\\mathbf x|\\mathbf z, \\mathbf q) \\propto \\displaystyle \\prod^{M}_{m=1} \\prod^{K}_{k=1} [f(\\mathbf x_m|\\mathbf q_k)]^{z_{m,k}}, f(ùê±m|ùê™k)f(\\mathbf x_m|\\mathbf q_k) relative frequency multi-locus genotype individual mm population kk. next step, derive f(ùê±m|ùê™k)f(\\mathbf x_m|\\mathbf q_k): f(ùê±m|ùê™k)‚àù‚àèl=1L‚àèj=1Jlqk,l,jxm,l,jf(\\mathbf x_m|\\mathbf q_k) \\propto \\displaystyle \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{x_{m,l,j}}_{k,l,j} combine two, p(ùê±|ùê≥,ùê™)‚àù‚àèm=1M‚àèk=1K[f(ùê±m|ùê™k)]zm,kp(\\mathbf x|\\mathbf z, \\mathbf q) \\propto \\displaystyle \\prod^{M}_{m=1} \\prod^{K}_{k=1} [f(\\mathbf x_m|\\mathbf q_k)]^{z_{m,k}} ‚àù‚àèm=1M‚àèk=1K[‚àèl=1L‚àèj=1Jlqk,l,jxm,l,j‚ãÖzm,k]\\propto \\displaystyle \\prod^{M}_{m=1} \\prod^{K}_{k=1} [\\displaystyle \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{x_{m,l,j} \\cdot z_{m,k}}_{k,l,j}] ‚àù‚àèk=1K‚àèl=1L‚àèj=1Jlqk,l,j‚àëm=1M(xm,l,j‚ãÖzm,k)\\propto \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\sum^{M}_{m=1} (x_{m,l,j} \\cdot z_{m,k})}_{k,l,j} Deriving likelihood p(ùê≤|ùê™)p(\\mathbf y|\\mathbf q) straightforward. product relative frequency multi-locus genotype population: p(ùê≤|ùê™)‚àù‚àèk=1K‚àèl=1L‚àèj=1Jlqk,l,jyk,l,jp(\\mathbf y|\\mathbf q) \\propto \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{y_{k,l,j}}_{k,l,j} p(q|ùõÉ)p(q|\\mathbf \\beta) Dirichlet prior distribution. probability density kernel6 ùê™ùõÉ‚àí1\\mathbf q^{\\mathbf \\beta - 1}. can express likelihood p(ùê™|ùõÉ)‚àù‚àèk=1K‚àèl=1L‚àèj=1Jlqk,l,jŒ≤l,j‚àí1p(\\mathbf q|\\mathbf \\beta) \\propto \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\beta_{l,j} - 1}_{k,l,j}. Put likelihoods together, p(ùê™|ùê±,ùê≤,ùê≥,ùõÉ)‚àùp(ùê±|ùê≥,ùê™)p(ùê≤|ùê™)p(ùê™|ùõÉ)p(\\mathbf q|\\mathbf x,\\mathbf y,\\mathbf z,\\mathbf\\beta) \\propto p(\\mathbf x|\\mathbf z, \\mathbf q) p(\\mathbf y|\\mathbf q) p(\\mathbf q|\\mathbf\\beta) ‚àù‚àèk=1K‚àèl=1L‚àèj=1Jlqk,l,j‚àëm=1M(xm,l,j‚ãÖzm,k)‚ãÖ‚àèk=1K‚àèl=1L‚àèj=1Jlqk,l,jyk,l,j‚ãÖ‚àèk=1K‚àèl=1L‚àèj=1Jlqk,l,jŒ≤l,j‚àí1\\propto \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\sum^{M}_{m=1} (x_{m,l,j} \\cdot z_{m,k})}_{k,l,j} \\cdot \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{y_{k,l,j}}_{k,l,j} \\cdot \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\beta_{l,j} - 1}_{k,l,j} =‚àèk=1K‚àèl=1L‚àèj=1Jlqk,l,j‚àëm=1M(xm,l,j‚ãÖzm,k)+yk,l,j+Œ≤l,j‚àí1= \\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\sum^{M}_{m=1} (x_{m,l,j} \\cdot z_{m,k}) + y_{k,l,j} + \\beta_{l,j} - 1}_{k,l,j} elementary recognize ‚àèk=1K‚àèl=1L‚àèj=1Jlqk,l,j‚àëm=1M(xm,l,j‚ãÖzm,k)+yk,l,j+Œ≤l,j‚àí1\\displaystyle \\prod^{K}_{k=1} \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} q^{\\sum^{M}_{m=1} (x_{m,l,j} \\cdot z_{m,k}) + y_{k,l,j} + \\beta_{l,j} - 1}_{k,l,j} kernel Dirichlet distribution. Hence, ùê™k,l|ùê±,ùê≤,ùê≥,ùõÉ‚àºDirich(‚àëm=1Mxm,l,jzm,k+yk,l,j+Œ≤l,j)\\mathbf q_{k,l}|\\mathbf x,\\mathbf y,\\mathbf z,\\mathbf\\beta \\sim Dirich(\\displaystyle \\sum^{M}_{m=1} x_{m,l,j} z_{m,k} + y_{k,l,j} + \\beta_{l,j}).","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"conditional-distribution-ppz-alpha","dir":"Articles","previous_headings":"Methods (math!) > Gibbs Sampler: where the fun go round and round","what":"Conditional distribution p(p|z, Œ±\\alpha)","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"Using logic previously, p(ùê©|ùê≥,ùõÇ)p(\\mathbf p|\\mathbf z,\\mathbf\\alpha) also Dirichlet-distributed due Dirichlet prior p(ùê©|ùõÇ)p(\\mathbf p|\\mathbf\\alpha) multinomial likelihood p(ùê≥|ùê©)p(\\mathbf z|\\mathbf p). p(ùê©|ùê≥,ùõÇ)‚àùp(ùê≥|ùê©)p(ùê©|ùõÇ)p(\\mathbf p|\\mathbf z,\\mathbf\\alpha) \\propto p(\\mathbf z|\\mathbf p) p(\\mathbf p|\\mathbf\\alpha) ‚àù‚àèm=1M‚àèk=1Kpkzm,k‚ãÖ‚àèk=1KpkŒ±k‚àí1\\propto \\displaystyle \\prod^{M}_{m=1} \\prod^{K}_{k=1} p^{z_{m,k}}_k \\cdot \\prod^{K}_{k=1} p^{\\alpha_k - 1}_k ‚àù‚àèk=1Kpk‚àëm=1Mzm,k+Œ±k‚àí1\\propto \\displaystyle \\prod^{K}_{k=1} p^{\\sum^M_{m=1}z_{m,k} + \\alpha_k - 1}_k , recognize kernel Dirichlet distribution: ùê©|ùê≥,ùõÇ‚àºDirich(‚àëm=1Mzm,k+Œ±k)\\mathbf p|\\mathbf z,\\mathbf\\alpha \\sim Dirich(\\displaystyle \\sum^M_{m=1}z_{m,k} + \\alpha_k)","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"algorithm","dir":"Articles","previous_headings":"Methods (math!) > Gibbs Sampler: where the fun go round and round","what":"Algorithm","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"one distribution figure can start Gibbs sampler routine (thought ‚Äôre set, lol). need know sample ùê≥m|ùê©,ùê™,ùê±m\\mathbf z_m|\\mathbf p, \\mathbf q, \\mathbf x_m, population identity individual fish mm (components 1 2) given population proportions genotype. probability fish mm belong population kk pkp_k, likelihood observing relative frequency genotype fish mm population kk f(ùê±m|ùê™k)f(\\mathbf x_m|\\mathbf q_k), probability fish mm belong population kk given population proportions genotype pk‚ãÖf(ùê±m|ùê™k)‚àëk‚Ä≤=1Kpk‚Ä≤‚ãÖf(ùê±m|ùê™k‚Ä≤)\\displaystyle \\frac{p_k \\cdot f(\\mathbf x_m|\\mathbf q_k)}{\\sum^K_{k'=1}p_{k'} \\cdot f(\\mathbf x_m|\\mathbf q_{k'})}. denominator sum one, need calculate numerator. ùê≥m|ùê©,ùê™,ùê±m\\mathbf z_m|\\mathbf p, \\mathbf q, \\mathbf x_m following distribution: ùê≥m|ùê©,ùê™,ùê±m‚àºMult(1,ùê∞m)\\mathbf z_m|\\mathbf p, \\mathbf q, \\mathbf x_m \\sim Mult(1, \\mathbf{w}_m), wm,k=pk‚ãÖf(ùê±m|ùê™k)w_{m,k} = p_k \\cdot f(\\mathbf x_m|\\mathbf q_k). draw initial values ùê™k\\mathbf q_k based prior distribution. figured pieces Gibbs sampler single baseline framework, can extend concept multistage framework. Conceptually, use Gibbs sampler sample full conditionals ùê™\\mathbf q, ùê©\\mathbf p, ùê≥\\mathbf z, ùê™(r)\\mathbf q^{(r)}, ùê©(r)\\mathbf p^{(r)}, ùê≥(r)\\mathbf z^{(r)}. full conditional distributions broad-scale baseline multistage framework stay counterparts single baseline framework. full conditional distributions Gibbs sampler regional stage : ùê™k,l(r)|ùê±(r),ùê≤(r),ùê≥(r),ùõÉ(r)‚àºDirich(‚àëm=1Mxm,l,j(r)zm,k(r)+yk,l,j(r)+Œ≤l,j(r))\\mathbf q^{(r)}_{k,l} | \\mathbf x^{(r)},\\mathbf y^{(r)},\\mathbf z^{(r)},\\mathbf\\beta^{(r)} \\sim Dirich(\\displaystyle \\sum^{M}_{m=1} x^{(r)}_{m,l,j} z^{(r)}_{m,k} + y^{(r)}_{k,l,j} + \\beta^{(r)}_{l,j}), ùê©(r)|ùê≥(r),ùê≥,‚Ñ¨(r),ùõÇ(r)‚àºDirich(‚àëm=1M(zm,k(r)|zm,b,‚Ñ¨m,b(r))+Œ±k(r))\\mathbf p^{(r)} | \\mathbf z^{(r)}, \\mathbf z, \\mathbf{\\mathscr B}^{(r)}, \\mathbf \\alpha^{(r)} \\sim Dirich(\\displaystyle \\sum^M_{m=1} (z^{(r)}_{m,k} | z_{m,b}, \\mathscr B^{(r)}_{m,b}) + \\alpha^{(r)}_k), ùê≥m(r)|ùê©(r),ùê™(r),ùê±m(r)‚àºMult(1,ùê∞m(r))\\mathbf z^{(r)}_m | \\mathbf p^{(r)}, \\mathbf q^{(r)}, \\mathbf x^{(r)}_m \\sim Mult(1, \\mathbf{w}^{(r)}_m), wm,k(r)‚àù(pk(r)‚ãÖ‚àèl=1L‚àèj=1Jlq(r)k,l,jxm,l,j)w^{(r)}_{m,k} \\propto (p^{(r)}_k \\cdot \\displaystyle \\prod^{L}_{l=1} \\prod^{J_l}_{j=1} {q^{(r)}}^{x_{m,l,j}}_{k,l,j}). initiate Gibbs sampler starting values ùê©(0)\\mathbf p^{(0)}, ùê™(0)\\mathbf q^{(0)}, ùê©(ùê´)(0)\\mathbf {p^{(r)}}^{(0)} ùê™(ùê´)(0)\\mathbf {q^{(r)}}^{(0)} based prior distributions. use subscript (t)^{(t)} denote ttth iteration Gibbs sampler. Sampling fully Bayesian model proceeds follows: t=1,2,...,Tt = 1,2,...,T, repeat Determine group memberships mixture individuals broad-scale stage, ùê≥m(t)|ùê©(t‚àí1),ùê™(t‚àí1),ùê±m‚àºMult(1,ùê∞m)\\mathbf z^{(t)}_m | \\mathbf p^{(t-1)}, \\mathbf q^{(t-1)}, \\mathbf x_m \\sim Mult(1, \\mathbf{w}_m). Determine group memberships mixture individuals sub-region regional stage, ùê≥m(r)(t)|ùê©(r)(t‚àí1),ùê™(r)(t‚àí1),ùê±m(r)‚àºMult(1,ùê∞m(r)){\\mathbf z^{(r)}_m}^{(t)} | {\\mathbf p^{(r)}}^{(t-1)}, {\\mathbf q^{(r)}}^{(t-1)}, \\mathbf x_m^{(r)} \\sim Mult(1, \\mathbf{w}^{(r)}_m), r=1,2,...,Rr = 1, 2, ..., R. Draw updated values, ùê™(t)\\mathbf q^{(t)}, ùê©(t)\\mathbf p^{(t)}, ùê™(r)(t){{\\mathbf q}^{(r)}}^{(t)} ùê©(r)(t){{\\mathbf p}^{(r)}}^{(t)} p(ùê™|ùê±,ùê≤,ùê≥(t),ùõÉ)p(\\mathbf q | \\mathbf x, \\mathbf y, \\mathbf z^{(t)}, \\mathbf \\beta), p(ùê©|ùê≥(t),ùõÇ)p(\\mathbf p | \\mathbf z^{(t)}, \\mathbf \\alpha), p(ùê™(r)|ùê±(r),ùê≤(r),ùê≥(r)(t),ùõÉ(r))p(\\mathbf q^{(r)} | \\mathbf x^{(r)}, \\mathbf y^{(r)}, {\\mathbf z^{(r)}}^{(t)}, \\mathbf \\beta^{(r)}) p(ùê©(r)|ùê≥(ùê´)(t),ùê≥(t),‚Ñ¨(r),ùõÇ(r))p(\\mathbf p^{(r)} | \\mathbf {z^{(r)}}^{(t)}, \\mathbf z^{(t)}, \\mathbf{\\mathscr B}^{(r)}, \\mathbf \\alpha^{(r)}) respectively. TT large enough ensure simulations converge posterior distribution. Usually takes thousands iterations. Implementing conditional GSI model requires slight modification algorithm. ùê™\\mathbf q ùê™(r)\\mathbf q^{(r)} need calculated initial step without updates, otherwise procedures remain .","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/articles/msgsi_vignette.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Ms.GSI in the multistage of genetic stock identification madness","text":"Brooks, S. P., . Gelman. 1998. General methods monitoring convergence iterative simulations. Journal Computational Graphical Statistics. 7:434‚Äì455. Carlin, B. T. Louis. 2009. Bayesian Methods Data Analysis, 3rd Edition. CRC Press. New York. Gelman, ., D. B. Rubin. 1992. Inference iterative simulation using multiple sequences. Statistical Science. 7:457‚Äì472. Gelman, ., J. Carlin, H. Stern, D. Dunson, . Vehtari D. Rubin. 2014. Bayesian Data Analysis, 3rd Edition. CRC Press. New York. Johnson, N.L., Kotz, S., Balakrishnan, N. 1997. Discrete multivariate distributions. Wiley & Sons, New York. Lee. E., T. Dann, H. Hoyt. 2021. Yukon River Chinook Genetic Baseline Improvements. Yukon River Panel Restoration Enhancement Fund Final Report, URE-163-19N. Moran, B.M. E.C. Anderson. 2018. Bayesian inference conditional genetic stock identification model. Canadian Journal Fisheries Aquatic Sciences. 76(4):551-560. https://doi.org/10.1139/cjfas-2018-0016 Pella, J. M. Masuda. 2001. Bayesian methods analysis stock mixtures genetic characters. Fish. Bull. 99:151‚Äì167. Robert, C. G. Casella. 2010. Introducing Monte Carlo Methods R. Springer. New York. Templin, W. D., J. E. Seeb, J. R. Jasper, . W. Barclay, L. W. Seeb. 2011. Genetic differentiation Alaska Chinook salmon: missing link migratory studies. Mol Ecol Resour. 11(Suppl 1):226-246. doi:10.1111/j.1755-0998.2010.02968.x.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Bobby Hsu. Author, maintainer. Alaska Dept. Fish & Game. Copyright holder.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hsu B (2025). Ms.GSI: Multistage Genetic Stock Identification. R package version 0.0.0.9000, https://github.com/boppingshoe/Ms.GSI.","code":"@Manual{,   title = {Ms.GSI: Multistage Genetic Stock Identification},   author = {Bobby Hsu},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/boppingshoe/Ms.GSI}, }"},{"path":"https://boppingshoe.github.io/Ms.GSI/index.html","id":"msgsi-","dir":"","previous_headings":"","what":"Multistage Genetic Stock Identification","title":"Multistage Genetic Stock Identification","text":"Ms.GSI help conducting multistage genetic stock identification. package includes functions setup input data, run multistage model, make summary statistics convergence diagnostics. also includes function making trace plots.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Multistage Genetic Stock Identification","text":"can install development version Ms.GSI GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"boppingshoe/Ms.GSI\", build_vignettes = TRUE)"},{"path":"https://boppingshoe.github.io/Ms.GSI/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Multistage Genetic Stock Identification","text":"example shows basic workflows running multistage model. First thing first, background: made scenario samples Chinook salmon bycatch Bering Sea groundfish fisheries. mixture sample contains Chinook North Pacific, interested contribution Yukon River. conduct GSI using broad-scale baseline (base_templin) combination regional baseline (base_yukon) multistage framework. fake Chinook data sets pre-loaded Ms.GSI package. prepare input data: Using prepared input data, run model four chains 150 iterations. reality, course run iterations. set first 50 iterations chain warm-ups (kept final output). ‚Äôs summary estimates convergence diagnostics. ‚Äôs function package make trace plots inspect mixing chains.  Details mathematical model integrated multistage framework instructions using Ms.GSI package can found ‚Äúarticles‚Äù tab package website. , installed Ms.GSI, can call article using vignette(\"msgsi_vignette\").","code":"library(Ms.GSI)  msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 7.569319 secs msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 150, nburn = 50, thin = 1, nchains = 4) #> Running model (and the category is... Femme Queen Vogue!) #> Time difference of 1.685267 secs #> April-21-2025 10:23  msgsi_out$summ_comb #> # A tibble: 12 √ó 9 #>    group                 mean  median      sd    ci.05   ci.95    p0    GR n_eff #>    <chr>                <dbl>   <dbl>   <dbl>    <dbl>   <dbl> <dbl> <dbl> <dbl> #>  1 Russia             2.27e-2 1.91e-2 0.0213  8.31e-12 0.0634  0.11   1.35 102.  #>  2 Coastal West Alas‚Ä¶ 9.83e-2 6.30e-2 0.110   1.21e-12 0.305   0.165  3.01  58.4 #>  3 North Alaska Peni‚Ä¶ 1.33e-2 9.47e-4 0.0204  1.06e-15 0.0535  0.265  1.20  58.8 #>  4 Northwest Gulf of‚Ä¶ 3.70e-1 3.72e-1 0.104   2.02e- 1 0.548   0      1.42  34.9 #>  5 Copper             7.05e-4 6.04e-7 0.00258 1.49e-20 0.00433 0.49   1.01 336.  #>  6 Northeast Gulf of‚Ä¶ 5.48e-4 1.08e-6 0.00195 1.11e-19 0.00258 0.475  1.02 400   #>  7 Coastal Southeast‚Ä¶ 1.51e-3 3.36e-6 0.00449 4.26e-18 0.00948 0.415  1.10 183.  #>  8 British Columbia   6.31e-4 9.65e-7 0.00191 1.03e-18 0.00384 0.455  1.08 278.  #>  9 WA/OR/CA           5.13e-4 8.51e-7 0.00158 3.24e-18 0.00288 0.492  1.04 371.  #> 10 Lower Yukon        2.42e-1 2.58e-1 0.136   3.23e- 2 0.447   0      2.37 103.  #> 11 Middle Yukon       7.03e-2 6.85e-2 0.0229  3.61e- 2 0.110   0      1.03 433.  #> 12 Upper Yukon        1.79e-1 1.81e-1 0.0339  1.29e- 1 0.244   0      1.03 468. tr_plot(obj = msgsi_out$trace_comb, pop_info = msgsi_out$comb_groups)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_templin.html","id":null,"dir":"Reference","previous_headings":"","what":"Templin baseline data. ‚Äî base_templin","title":"Templin baseline data. ‚Äî base_templin","text":"example genotype data preparing msgsi input data rubias format (prep_msgsi_data() can also take GCL format) making road-scale baseline","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_templin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Templin baseline data. ‚Äî base_templin","text":"","code":"base_templin"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_templin.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Templin baseline data. ‚Äî base_templin","text":"tibble 29363 rows 60 variables:","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_templin.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Templin baseline data. ‚Äî base_templin","text":"ADF&G GCL database LOKI","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_yukon.html","id":null,"dir":"Reference","previous_headings":"","what":"Yukon baseline data. ‚Äî base_yukon","title":"Yukon baseline data. ‚Äî base_yukon","text":"example genotype data preparing msgsi input data rubias format (prep_msgsi_data() can also take GCL format) making regional, finer-scale baseline","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_yukon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Yukon baseline data. ‚Äî base_yukon","text":"","code":"base_yukon"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_yukon.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Yukon baseline data. ‚Äî base_yukon","text":"tibble 5435 rows 358 variables:","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/base_yukon.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Yukon baseline data. ‚Äî base_yukon","text":"ADF&G GCL database LOKI","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":null,"dir":"Reference","previous_headings":"","what":"Individual assignment summary ‚Äî indiv_assign","title":"Individual assignment summary ‚Äî indiv_assign","text":"Individual assignment summary","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Individual assignment summary ‚Äî indiv_assign","text":"","code":"indiv_assign(mdl_out, mdl_dat, show_broadscale_grps = TRUE)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Individual assignment summary ‚Äî indiv_assign","text":"mdl_out Model output object name. mdl_dat Input data object name. show_broadscale_grps Set FALSE want proportions broad-scale groups combined. Default = TRUE.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Individual assignment summary ‚Äî indiv_assign","text":"Individual assignment summary","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/indiv_assign.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Individual assignment summary ‚Äî indiv_assign","text":"","code":"# set up input data and run multistage model msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 10.01601 secs  # run model msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 25, nburn = 15, thin = 1, nchains = 1) #> Running model (and the category is... Linen Vs. Silk!) #> Time difference of 1.561602 secs #> May-22-2025 20:42  # individual assignment summary ind_iden <- indiv_assign(msgsi_out, msgsi_dat)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/mix.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixture data. ‚Äî mix","title":"Mixture data. ‚Äî mix","text":"example genotype data preparing msgsi input data rubias format (prep_msgsi_data() can also take GCL format) making mixed population data made mixture sample, real","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/mix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixture data. ‚Äî mix","text":"","code":"mix"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/mix.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mixture data. ‚Äî mix","text":"tibble 150 rows 358 variables:","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/mix.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mixture data. ‚Äî mix","text":"ADF&G GCL database LOKI","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":null,"dir":"Reference","previous_headings":"","what":"Run multistage GSI model ‚Äî msgsi_mdl","title":"Run multistage GSI model ‚Äî msgsi_mdl","text":"Run multistage GSI model","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run multistage GSI model ‚Äî msgsi_mdl","text":"","code":"msgsi_mdl(   dat_in,   nreps,   nburn,   thin,   nchains,   nadapt = 0,   keep_burn = FALSE,   cond_gsi = TRUE,   file_path = NULL,   seed = NULL,   iden_output = TRUE,   p1_prior_weight = NULL,   p2_prior_weight = NULL )"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run multistage GSI model ‚Äî msgsi_mdl","text":"dat_in Name input data. nreps Total number iterations (includes burn-ins). nburn Number warm-runs. thin Frequency thin output. nchains Number independent MCMC processes. nadapt Number adaptation run (default 0). available running model fully Bayesian mode. keep_burn save burn-ins (default FALSE). cond_gsi run model conditional GSI mode (default TRUE). file_path File path save output. Leave empty want save output. seed Random seed reproducibility. Default NULL (random seed). iden_output Option trace history individual assignments included final output. Default TRUE. p1_prior_weight optional tibble specify weight broad-scale reporting group. Columns repunit, grpvec, weight. p2_prior_weight optional tibble specify weight regional reporting group. Columns repunit, grpvec, weight.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run multistage GSI model ‚Äî msgsi_mdl","text":"list contains reporting group proportion summary trace tier 1 (summ_t1, trace_t1), tier 2 (summ_t2, trace_t2) two tiers combined (summ_comb, trace_comb), record individual assignment first tier individual (idens).","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/msgsi_mdl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run multistage GSI model ‚Äî msgsi_mdl","text":"","code":"# setup input data msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 9.358611 secs  # run multistage model msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 25, nburn = 15, thin = 1, nchains = 1) #> Running model (and the category is... Stone Cold Face!) #> Time difference of 1.490916 secs #> May-22-2025 20:42"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Preparing multistage GSI input data ‚Äî prep_msgsi_data","title":"Preparing multistage GSI input data ‚Äî prep_msgsi_data","text":"Preparing multistage GSI input data","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preparing multistage GSI input data ‚Äî prep_msgsi_data","text":"","code":"prep_msgsi_data(   mixture_data,   baseline1_data,   baseline2_data,   pop1_info,   pop2_info,   sub_group,   file_path = NULL,   loci1 = NULL,   loci2 = NULL )"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preparing multistage GSI input data ‚Äî prep_msgsi_data","text":"mixture_data Individual fish loci tier 1 tier 2. Mixture data GCL rubias format. baseline1_data Tier 1 baseline data GCL rubias format. baseline2_data Tier 2 baseline data GCL rubias format. pop1_info Population information tier 1. tibble columns collection (collection names), repunit (reporting unit names), grpvec (group numbers), origin (wild/hatchery). pop2_info Population information tier 2. tibble columns collection (collection names), repunit (reporting unit names), grpvec (group numbers). sub_group Group numbers groups interest. Group id numbers tier 1 identify groups tier 2. file_path want save copy input data. Leave empty want save copy. loci1 Optional. Provide loci (tier 1) fail-safe check. loci2 Optional. Provide loci (tier 2) fail-safe check.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preparing multistage GSI input data ‚Äî prep_msgsi_data","text":"list objects input data msgsi_mdl()","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/prep_msgsi_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Preparing multistage GSI input data ‚Äî prep_msgsi_data","text":"","code":"msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 9.179814 secs"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/stratified_estimator_msgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Stratified estimator for Ms.GSI ‚Äî stratified_estimator_msgsi","title":"Stratified estimator for Ms.GSI ‚Äî stratified_estimator_msgsi","text":"Stratified estimator Ms.GSI","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/stratified_estimator_msgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stratified estimator for Ms.GSI ‚Äî stratified_estimator_msgsi","text":"","code":"stratified_estimator_msgsi(   mdl_out = NULL,   path = NULL,   mixvec,   catchvec,   cv = NULL,   new_pop_info = NULL )"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/stratified_estimator_msgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stratified estimator for Ms.GSI ‚Äî stratified_estimator_msgsi","text":"mdl_out Optional. Ms.GSI output object name combining group proportions harvest single mixture. path find output mixture folder. mixvec Character vector mixture sillies used locate folders output .csv files lives, mdl_out provided. catchvec Numeric vector harvest mixture/stratum, must order mixvec. cv Numeric vector harvest estimate coefficients variation stratum, must order mixvec. new_pop_info Population information new grouping. tibble columns repunit new_repunit. repunit names original reporting groups.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/stratified_estimator_msgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stratified estimator for Ms.GSI ‚Äî stratified_estimator_msgsi","text":"tibble proportions harvest numbers reporting group combined mixtures/strata.","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/stratified_estimator_msgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stratified estimator for Ms.GSI ‚Äî stratified_estimator_msgsi","text":"","code":"if (FALSE) { # \\dontrun{ new_groups <- mdl_out$summ_comb %>% dplyr::select(group) %>%  dplyr::mutate(new_repunit = c(rep(\"broad\", 9), rep(\"regional\", 3))) %>%  dplyr::rename(repunit = group)  stratified_estimator_msgsi(path = \"test\", mixvec = c(\"m1\", \"m2\", \"m3\"), catchvec = c(4500, 5000, 3000), cv = c(0.5, 0.1 ,0.3), new_pop_info = new_groups) } # }"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/templin_pops211.html","id":null,"dir":"Reference","previous_headings":"","what":"Templin population infomation. ‚Äî templin_pops211","title":"Templin population infomation. ‚Äî templin_pops211","text":"tibble contains collection name, reporting unit, group number 211 populations Templin baseline","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/templin_pops211.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Templin population infomation. ‚Äî templin_pops211","text":"","code":"templin_pops211"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/templin_pops211.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Templin population infomation. ‚Äî templin_pops211","text":"tibble 211 rows 3 variables: collection, repunit, grpvec","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot MCMC trace ‚Äî tr_plot","title":"Plot MCMC trace ‚Äî tr_plot","text":"Plot MCMC trace","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot MCMC trace ‚Äî tr_plot","text":"","code":"tr_plot(obj, nburn = 0, thin = 1, pop_info = NULL)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot MCMC trace ‚Äî tr_plot","text":"obj Trace model output. nburn Number burn-set ran model. Default 0 save burn-ins (keep_burn = FALSE). thin Number thinning set ran model. Default 1 (thinning). pop_info Population information. tibble columns collection (collection names), repunit (reporting unit names), grpvec (group numbers).","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot MCMC trace ‚Äî tr_plot","text":"Trace plot ggplot","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/tr_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot MCMC trace ‚Äî tr_plot","text":"","code":"# set up input data and run multistage model msgsi_dat <-   prep_msgsi_data(mixture_data = mix,   baseline1_data = base_templin, baseline2_data = base_yukon,   pop1_info = templin_pops211, pop2_info = yukon_pops50, sub_group = 3:5) #> Compiling input data, may take a minute or two... #> Time difference of 9.116452 secs  msgsi_out <- msgsi_mdl(msgsi_dat, nreps = 25, nburn = 15, thin = 1, nchains = 1) #> Running model (and the category is... Best Dressed!) #> Time difference of 1.467058 secs #> May-22-2025 20:42  # trace plot tr_plot(obj = msgsi_out$trace_comb, pop_info = msgsi_out$comb_groups)"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/yukon_pops50.html","id":null,"dir":"Reference","previous_headings":"","what":"Yukon population infomation. ‚Äî yukon_pops50","title":"Yukon population infomation. ‚Äî yukon_pops50","text":"tibble contains collection name, reporting unit, group number 50 populations Yukon River baseline","code":""},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/yukon_pops50.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Yukon population infomation. ‚Äî yukon_pops50","text":"","code":"yukon_pops50"},{"path":"https://boppingshoe.github.io/Ms.GSI/reference/yukon_pops50.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Yukon population infomation. ‚Äî yukon_pops50","text":"tibble 50 rows 3 variables: collection, repunit, grpvec","code":""}]
